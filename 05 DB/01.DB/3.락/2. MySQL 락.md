[[10ë¶„ í…Œì½”í†¡] ë§ˆë£¨ì˜ ë°ì´í„°ë² ì´ìŠ¤ Lock - YouTube](https://www.youtube.com/watch?v=ZXV6ZqMyJLg)
[[10ë¶„ í…Œì½”í†¡] â›²ï¸ ì˜¤ì¦ˆì˜ á„ƒá…¦á„‹á…µá„á…¥á„‡á…¦á„‹á…µá„‰á…³ Lock - YouTube](https://www.youtube.com/watch?v=onBpJRDSZGA)
[(27) [10ë¶„ í…Œì½”í†¡] ðŸ§ì¹´ì¼ì˜ ë°ì´í„°ë² ì´ìŠ¤ ë½ - YouTube](https://www.youtube.com/watch?v=w6sFR3ZM64c&list=PLgXGHBqgT2TvpJ_p9L_yZKPifgdBOzdVH&index=281)

[5. íŠ¸ëžœìž­ì…˜ê³¼ ìž ê¸ˆ (tistory.com)](https://jwkim96.tistory.com/264)

#RealMyqs03

---
# MySQL ì—”ì§„ì˜ ìž ê¸ˆ
## MySQL ì—ì„œ ì‚¬ìš©ë˜ëŠ” ìž ê¸ˆ ì¢…ë¥˜ëŠ”? âœ”
1) MySQL ì—”ì§„ ìž ê¸ˆ : ìŠ¤í† ë¦¬ì§€ ì—”ì§„ì— ì˜í–¥ì„ ë¯¸ì¹¨
2) ìŠ¤í† ë¦¬ì§€ ì—”ì§„ ìž ê¸ˆ : ìŠ¤í† ë¦¬ì§€ ì—”ì§„ê°„ ìƒí˜¸ ì˜í–¥ì„ ì£¼ì§€ëŠ” ì•ŠìŒ


## ê¸€ë¡œë²Œ ë½
ê¸€ë¡œë²Œ ë½(Global Lock)ì€ MySQL **ì„œë²„ ì „ì²´ì— ì˜í–¥ì„ ì£¼ëŠ” ìž ê¸ˆ**ìž…ë‹ˆë‹¤. 

ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš°ì— ì‚¬ìš©í•©ë‹ˆë‹¤.
1. ë°ì´í„°ë² ì´ìŠ¤ ì „ì²´ì˜ ì¼ê´€ëœ ìŠ¤ëƒ…ìƒ· ë˜ëŠ” ë°±ì—…ì„ ìƒì„±í•  ë•Œ
ê¸€ë¡œë²Œ ë½ì€ ë°ì´í„°ë² ì´ìŠ¤ì˜ í˜„ìž¬ ìƒíƒœë¥¼ ì•ˆì „í•˜ê²Œ ë°±ì—…í•  ìˆ˜ ìžˆë„ë¡ ëª¨ë“  ìž‘ì—…ì„ ì¼ì‹œ ì¤‘ë‹¨ì‹œí‚µë‹ˆë‹¤.

2. ë°ì´í„°ë² ì´ìŠ¤ ë³µì‚¬ ë˜ëŠ” ë³µì› ì‹œ
ë°ì´í„°ë² ì´ìŠ¤ ë³µì œ ìž‘ì—… ì¤‘ì—ëŠ” ì‹¤ì‹œê°„ ì„œë¹„ìŠ¤ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šê¸° ìœ„í•´ ìž‘ì—…ì„ ì¼ì‹œ ì¤‘ë‹¨í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. ê¸€ë¡œë²Œ ë½ì€ ì´ëŸ¬í•œ ìž‘ì—…ì„ ì•ˆì „í•˜ê²Œ ìˆ˜í–‰í•  ìˆ˜ ìžˆë„ë¡ ë„ì›€ì„ ì¤ë‹ˆë‹¤.

â–¶ì½”ë“œ ì˜ˆì‹œ
1. `FLUSH TABLES WITH READ LOCK (FTWRL)`
ì´ ëª…ë ¹ì–´ëŠ” ê¸€ë¡œë²Œ ë¦¬ë“œ ë½ì„ ìˆ˜ë¦½í•˜ì—¬ **ëª¨ë“  í…Œì´ë¸”ì— ëŒ€í•œ ì“°ê¸° ìž‘ì—…ì„ ì¼ì‹œ ì¤‘ì§€**í•©ë‹ˆë‹¤. FTWRLì´ í™œì„±í™”ë˜ëŠ” ë™ì•ˆ ì“°ê¸° ìž‘ì—…ì´ ì°¨ë‹¨ë˜ê¸° ë•Œë¬¸ì— **ì„±ëŠ¥ ì €í•˜ê°€ ë°œìƒí•  ìˆ˜** ìžˆìŠµë‹ˆë‹¤.
```sql
FLUSH TABLES WITH READ LOCK;
-- ... ì—¬ê¸°ì„œ ë°±ì—…, ìœ ì§€ ê´€ë¦¬ ìž‘ì—… ë“±ì„ ìˆ˜í–‰
UNLOCK TABLES; -- ë½ í•´ì œ ë° íŠ¸ëžœìž­ì…˜ ìž¬ê°œ
```

2. `LOCK INSTANCE FOR BACKUP`
ì´ ëª…ë ¹ì–´ëŠ” MySQL 8.0ë¶€í„° ë„ìž…ëœ ë°±ì—… ëª…ë ¹ìœ¼ë¡œ, FLUSH TABLES WITH READ LOCKì˜ ë‹¨ì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.Â `LOCK INSTANCE FOR BACKUP`ëŠ” íŒŒì¼ ë° í…Œì´ë¸” ìŠ¤íŽ˜ì´ìŠ¤ì— ëŒ€í•œ ê¸€ë¡œë²Œ ë°±ì—… ë½ì„ ê±¸ì–´ ë°±ì—… ìž‘ì—…ì´ ë°ì´í„°ì™€ ì €ìž¥ì†Œ íŒŒì¼ ê°„ì˜ ë¶ˆì¼ì¹˜ ë¬¸ì œì—†ì´ ìˆ˜í–‰ë˜ë„ë¡ í•©ë‹ˆë‹¤. ì´ ëª…ë ¹ì–´ëŠ” **InnoDB ìŠ¤í† ë¦¬ì§€ ì—”ì§„ì—ì„œë§Œ ì •ìƒ ìž‘ë™**í•˜ë©°, ë°ì´í„°ë² ì´ìŠ¤ ë‚´ì˜ íŠ¸ëžœìž­ì…˜ ì²˜ë¦¬ê°€ ì°¨ë‹¨ë˜ì§€ ì•Šë„ë¡ í•´ **ì“°ê¸° ìž‘ì—…ì´ ê³„ì† ì§„í–‰ë  ìˆ˜** ìžˆìŠµë‹ˆë‹¤.
```sql
LOCK INSTANCE FOR BACKUP;
```


## í…Œì´ë¸” ë½
ë°ì´í„°ë² ì´ìŠ¤ ë‚´ì˜ íŠ¹ì • í…Œì´ë¸”ì— ëŒ€í•´ ëª¨ë“  ì•¡ì„¸ìŠ¤ë¥¼ ìž ê·¸ê±°ë‚˜ ë™ì‹œì„±ì„ ì œì–´í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•©ë‹ˆë‹¤. **íŠ¹ì • í…Œì´ë¸”ì— ëŒ€í•œ ì ‘ê·¼ì„ ë™ê¸°í™”í•˜ê¸° ìœ„í•´ ì‚¬ìš©**ë©ë‹ˆë‹¤. í…Œì´ë¸” ë½ì€ ì¼ë°˜ì ì¸ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” **ê±°ì˜ ì‚¬ìš©í•  í•„ìš”ê°€ ì—†ìŠµë‹ˆë‹¤.**

ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš°ì— ì‚¬ìš©í•©ë‹ˆë‹¤.
1. **ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ í•œ ë²ˆì— ìˆ˜ì •í•˜ê±°ë‚˜ ì‚½ìž…í•˜ëŠ” ê²½ìš°**
ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•  ë•Œ í…Œì´ë¸” ë½ì„ ì‚¬ìš©í•˜ë©´ ë½ ê²½ìŸì„ ì¤„ì´ê³  íŠ¸ëžœìž­ì…˜ ë¦¬ì†ŒìŠ¤ë¥¼ ì ˆì•½í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ëŒ€ê·œëª¨ë¡œ ê°±ì‹ í•˜ê±°ë‚˜ ì´ˆê¸° ë°ì´í„°ë¥¼ ì‚½ìž…í•  ë•Œ í…Œì´ë¸” ë½ì„ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

2. **í…Œì´ë¸” êµ¬ì¡° ë³€ê²½ ìž‘ì—… ì‹œ**
í…Œì´ë¸” êµ¬ì¡°ë¥¼ ë³€ê²½í•˜ëŠ” ìž‘ì—…(ì˜ˆ: ALTER TABLE, TRUNCATE TABLE) ì¤‘ì—ëŠ” ë‹¤ë¥¸ ìž‘ì—…ì´ í…Œì´ë¸”ì— ë™ì‹œì— ì•¡ì„¸ìŠ¤í•˜ì§€ ëª»í•˜ë„ë¡ í…Œì´ë¸” ë½ì„ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

```sql
-- ì½ê¸° ë½ (ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì—ì„œ í…Œì´ë¸”ì„ ì½ì„ ìˆ˜ ìžˆì§€ë§Œ ì“°ê¸°ë¥¼ ì°¨ë‹¨í•©ë‹ˆë‹¤.)
LOCK TABLES table_name READ;
-- ... ì—¬ê¸°ì„œ í•„ìš”í•œ ìž‘ì—…ì„ ìˆ˜í–‰
UNLOCK TABLES; -- ë½ í•´ì œ

-- ì“°ê¸° ë½ (ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì—ì„œ í…Œì´ë¸” ì½ê¸° ë° ì“°ê¸°ë¥¼ ëª¨ë‘ ì°¨ë‹¨í•©ë‹ˆë‹¤.)
LOCK TABLES table_name WRITE;
-- ... ì—¬ê¸°ì„œ í•„ìš”í•œ ìž‘ì—…ì„ ìˆ˜í–‰
UNLOCK TABLES; -- ë½ í•´ì œ
```


## ë„¤ìž„ë“œ ë½
ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸” ë˜ëŠ” í–‰ì´ ì•„ë‹Œ **ì‚¬ìš©ìžê°€ ì •ì˜í•œ ê³ ìœ í•œ ë¬¸ìžì—´ ê¸°ë°˜ì˜ ë½**ìž…ë‹ˆë‹¤. **ì—¬ëŸ¬ í´ë¼ì´ì–¸íŠ¸ ê°„ì— ë™ê¸°í™”ë¥¼ ì œê³µí•˜ê±°ë‚˜ ì„œë¡œ ë‹¤ë¥¸ ì„¸ì…˜ì—ì„œ ìˆœì°¨ì ìœ¼ë¡œ ìž‘ì—…**ì„ ìˆ˜í–‰í•˜ëŠ” ë° ìœ ìš©í•œ ë°©ë²•ìž…ë‹ˆë‹¤.

ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš°ì— ì‚¬ìš©í•©ë‹ˆë‹¤.
1. ì–´í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ì˜ ë™ì‹œì„± ì œì–´
ë°ì´í„°ë² ì´ìŠ¤ì™€ ê´€ë ¨ì´ ì—†ê±°ë‚˜ ë°ì´í„°ë² ì´ìŠ¤ ìˆ˜ì¤€ì˜ ë½ìœ¼ë¡œ ì²˜ë¦¬í•˜ê¸° ì–´ë ¤ìš´ ì–´í”Œë¦¬ì¼€ì´ì…˜ì˜ ë™ì‹œì„± ë¬¸ì œë¥¼ ì²˜ë¦¬í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

2. ì—¬ëŸ¬ ë°ì´í„°ë² ì´ìŠ¤ ê°„ ë™ì‹œì„± ì œì–´
í…Œì´ë¸” ë˜ëŠ” í–‰ ë ˆë²¨ ë½ìœ¼ë¡œ ì²˜ë¦¬í•  ìˆ˜ ì—†ëŠ” ì—¬ëŸ¬ ë°ì´í„°ë² ì´ìŠ¤ ì‚¬ì´ì—ì„œ ë°œìƒí•˜ëŠ” ë™ì‹œì„± ë¬¸ì œì— ëŒ€ì‘í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤.

3. ë‹¤ì¤‘ í´ë¼ì´ì–¸íŠ¸ í™˜ê²½ì—ì„œ ê³µìœ ëœ ìžì›ì— ëŒ€í•œ ë™ì‹œì„± ì œì–´
ì—¬ëŸ¬ ì—”ë“œ ìœ ì €ê°€ ì• í”Œë¦¬ì¼€ì´ì…˜ ë° ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ì‹œì— ë™ì¼í•œ ìž‘ì—…ì„ ìˆ˜í–‰í•´ì•¼ í•˜ëŠ” ê²½ìš°, ë„¤ìž„ë“œ ë½ì„ ì‚¬ìš©í•˜ì—¬ ë™ì‹œ ì ‘ê·¼ì„ ì¡°ì ˆí•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
sql

```sql
-- ë„¤ìž„ë“œ ë½ ì„¤ì • (lock_nameì´ë¼ëŠ” ë½ ì´ë¦„ì„ ì‚¬ìš©)
SELECT GET_LOCK('lock_name', 10); -- ë½ì„ ì–»ìœ¼ë ¤ê³  ì‹œë„í•˜ê³ , ìµœëŒ€ 10ì´ˆ ë™ì•ˆ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.

-- ... ì—¬ê¸°ì„œ í•„ìš”í•œ ìž‘ì—…ì„ ìˆ˜í–‰

-- ë½ í•´ì œ
SELECT RELEASE_LOCK('lock_name');
```

â–¶ ì‹¤ìƒí™œ ì˜ˆì‹œ
ì˜¨ë¼ì¸ ìƒì ì—ì„œ íŠ¹ì • ì œí’ˆì˜ í•œì •íŒ ë¬¼í’ˆì„ íŒë§¤í•œë‹¤ê³  ê°€ì •í•´ë³´ê² ìŠµë‹ˆë‹¤. ì´ ì œí’ˆì€ ë§¤ìš° ì¸ê¸°ê°€ ìžˆìœ¼ë©°, ë‹¨ í•œ ê°œì˜ í’ˆëª©ë§Œ íŒë§¤ê°€ ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ê²½ìš° ë„¤ìž„ë“œ ë½ì„ ì‚¬ìš©í•˜ì—¬ í•œ ë²ˆì— í•œ ëª…ì˜ ê³ ê°ë§Œ ì œí’ˆì„ êµ¬ë§¤í•˜ë„ë¡ ë™ì‹œì„±ì„ ê´€ë¦¬í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

```sql
-- ê³ ê° A

-- ê³ ê° Aê°€ ì œí’ˆì„ êµ¬ë§¤í•˜ë ¤ê³  ì‹œë„í•˜ë©´, ê³ ê° Aê°€ ë½ ì„ ì–»ì„ ë•Œê¹Œì§€ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.
SELECT GET_LOCK('limited_item_purchase', 10); -- ìµœëŒ€ 10ì´ˆ ë™ì•ˆ ê¸°ë‹¤ë¦½ë‹ˆë‹¤.

-- ê³ ê° Aê°€ ì§€ê¸ˆê¹Œì§€ íŒë§¤ë˜ì§€ ì•Šì€ ì œí’ˆì„ í™•ì¸í•˜ê³  êµ¬ë§¤í•©ë‹ˆë‹¤.
-- ... ì—¬ê¸°ì„œ ë¬¼í’ˆ í™•ì¸ ë° êµ¬ë§¤ ìž‘ì—… ìˆ˜í–‰

-- êµ¬ë§¤ê°€ ì™„ë£Œë˜ë©´ ë½ì„ í•´ì œí•©ë‹ˆë‹¤.
SELECT RELEASE_LOCK('limited_item_purchase');
```

ì´ëŸ¬í•œ ë°©ì‹ìœ¼ë¡œ ë„¤ìž„ë“œ ë½ì„ ì‚¬ìš©í•˜ë©´ í•œ ë²ˆì— í•œ ëª…ì˜ ê³ ê°ë§Œ ì œí’ˆì„ êµ¬ë§¤í•  ìˆ˜ ìžˆìœ¼ë¯€ë¡œ ë™ì‹œì„± ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ, ì§ì ‘ì ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ ìžì›ì— ë½ì´ í•„ìš”í•œ ê²½ìš°ë¼ë©´, **ì¼ë°˜ì ìœ¼ë¡œ í–‰ ë ˆë²¨ ë½ì´ë‚˜ í…Œì´ë¸” ë ˆë²¨ ë½ì„ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë” íš¨ê³¼ì **ìž…ë‹ˆë‹¤.


## ë©”íƒ€ë°ì´í„° ë½
â–¶ë©”íƒ€ë°ì´í„°ëž€?
ë°ì´í„°ë² ì´ìŠ¤ì˜ ë§¥ë½ì—ì„œ ë©”íƒ€ë°ì´í„°ëŠ” **í…Œì´ë¸”, ì¹¼ëŸ¼, ì¸ë±ìŠ¤, ì œì•½ ì¡°ê±´, ë·°** ë“±ê³¼ ê´€ë ¨ëœ **êµ¬ì¡°, ì†ì„±, ì œì•½ ì¡°ê±´ ë“±ì˜ ì •ë³´ë¥¼ í¬í•¨**í•©ë‹ˆë‹¤. ë©”íƒ€ë°ì´í„°ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì˜ ê¸°ëŠ¥ê³¼ íš¨ìœ¨ì„±ì„ ìœ ì§€í•˜ê³  **ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°ì™€ ì—”í„°í‹° ê°„ì˜ ê´€ê³„ë¥¼ ì œì–´**í•˜ëŠ” ë° ì¤‘ìš”í•œ ì—­í• ì„ í•©ë‹ˆë‹¤.

ë°ì´í„°ë² ì´ìŠ¤ ì‹œìŠ¤í…œì—ì„œ ìŠ¤í‚¤ë§ˆ ê°ì²´(í…Œì´ë¸”, ë·°, ì¸ë±ìŠ¤ ë“±)ì˜ ë©”íƒ€ë°ì´í„°ë¥¼ ë™ì‹œì— ìˆ˜ì •í•˜ê±°ë‚˜ ì•¡ì„¸ìŠ¤í•˜ëŠ” ê²ƒì„ ì œì–´í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë©ë‹ˆë‹¤. 

ë‹¤ìŒê³¼ ê°™ì€ ìƒí™©ì—ì„œ ì‚¬ìš©ë©ë‹ˆë‹¤.
1. **í…Œì´ë¸” êµ¬ì¡° ë³€ê²½**
ë©”íƒ€ë°ì´í„° ë½ì€ í…Œì´ë¸”ì˜ êµ¬ì¡°ë¥¼ ë³€ê²½í•˜ë ¤ëŠ” ë™ì•ˆ(ì˜ˆ: ALTER TABLE, DROP TABLE, TRUNCATE TABLE) ëª¨ë“  ëŒ€ê¸° ì¤‘ì¸ ìž‘ì—…ì´ í•´ë‹¹ í…Œì´ë¸”ì˜ êµ¬ì¡°ë¥¼ ì°¸ì¡°í•˜ëŠ” ê²ƒì„ ì°¨ë‹¨í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. í…Œì´ë¸” êµ¬ì¡° ë³€ê²½ ìž‘ì—…ì´ ì™„ë£Œë˜ë©´ ë©”íƒ€ë°ì´í„° ë½ì´ í•´ì œë˜ê³  ëŒ€ê¸° ì¤‘ì´ë˜ ìž‘ì—…ë“¤ì´ ì§„í–‰ë©ë‹ˆë‹¤.

2. **íŠ¸ëžœìž­ì…˜ ë‚´ë¶€ì˜ ê°ì²´ ì ‘ê·¼**
ë©”íƒ€ë°ì´í„° ë½ì€ íŠ¸ëžœìž­ì…˜ ë²”ìœ„ ë‚´ì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ ê°ì²´ì— ëŒ€í•œ ì ‘ê·¼ì´ ì›í™œí•˜ê²Œ ì´ë£¨ì–´ì§€ë„ë¡ ë³´ìž¥í•˜ëŠ” ë° ê¸°ì—¬í•©ë‹ˆë‹¤. íŠ¹ì • íŠ¸ëžœìž­ì…˜ì—ì„œ ê°ì²´ì— ëŒ€í•œ ë©”íƒ€ë°ì´í„° ë½ì„ ë³´ìœ í•˜ê³  ìžˆëŠ” ê²½ìš°, ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì´ í•´ë‹¹ ê°ì²´ë¥¼ ì°¸ì¡°í•  ìˆ˜ ìžˆë„ë¡ ì›í™œí•˜ê²Œ ì²˜ë¦¬ë©ë‹ˆë‹¤.


## ë©”íƒ€ ë°ì´í„° ë½ ì˜ˆì‹œ
[[MySQL] Metadata Lock (tistory.com)](https://ohtaeg.tistory.com/16)
ë©”íƒ€ë°ì´í„° ë½ì€ ë°ì´í„°ë² ì´ìŠ¤ ì‹œìŠ¤í…œì—ì„œ **ìžë™ìœ¼ë¡œ ê´€ë¦¬**ë˜ë¯€ë¡œ ì¼ë°˜ì ìœ¼ë¡œ ëª…ì‹œì ìœ¼ë¡œ í˜¸ì¶œí•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤. 

ì˜ˆë¥¼ ë“¤ì–´, ê³ ê° ì •ë³´ë¥¼ ì¶”ì í•˜ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ `customer` í…Œì´ë¸”ì— ëŒ€í•´ **ì¸ë±ìŠ¤ë¥¼ ì¶”ê°€í•˜ê³  ì‹¶ë‹¤ê³  ê°€ì •**í•´ë´…ì‹œë‹¤. ì—¬ëŸ¬ ì‚¬ìš©ìžê°€ ë™ì‹œì— ë°ì´í„°ë² ì´ìŠ¤ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìžˆìœ¼ë¯€ë¡œ, ì¸ë±ìŠ¤ê°€ ì¶”ê°€ë˜ëŠ” ë™ì•ˆ ë‹¤ë¥¸ ì‚¬ìš©ìžê°€ **í•´ë‹¹ í…Œì´ë¸”ì„ ìˆ˜ì •í•˜ê±°ë‚˜ ì½ëŠ” ê²ƒì„ ì°¨ë‹¨**í•´ì•¼ í•©ë‹ˆë‹¤.

1. ì‚¬ìš©ìž AëŠ” `ALTER TABLE` ëª…ë ¹ì„ ì‚¬ìš©í•˜ì—¬ `customer` í…Œì´ë¸”ì—ì„œ ìƒˆ ì¸ë±ìŠ¤ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
```sql
ALTER TABLE customer ADD INDEX (last_name);
```

2. ì‚¬ìš©ìž BëŠ” ë™ì‹œì— `customer` í…Œì´ë¸”ì—ì„œ ì •ë³´ë¥¼ ê²€ìƒ‰í•˜ë ¤ê³  í•©ë‹ˆë‹¤.
```sql
SELECT * FROM customer WHERE last_name = 'Smith';
```

`ALTER TABLE` ëª…ë ¹ì„ ì‹¤í–‰í•˜ëŠ” ë™ì•ˆ ì‹œìŠ¤í…œì€ ìžë™ìœ¼ë¡œ `customer` í…Œì´ë¸”ì˜ ë©”íƒ€ë°ì´í„°ì— ë½ì„ ì„¤ì •í•©ë‹ˆë‹¤. ì´ ë½ì€ í…Œì´ë¸” êµ¬ì¡° ë³€ê²½ ìž‘ì—…ì´ ì™„ë£Œë˜ê¸° ì „ê¹Œì§€ ë‹¤ë¥¸ ì‚¬ìš©ìžê°€ í•´ë‹¹ í…Œì´ë¸”ì— ëŒ€í•œ DDL ë° DML ìž‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ê²ƒì„ ì°¨ë‹¨í•©ë‹ˆë‹¤.


# InnoDB ìŠ¤í† ë¦¬ì§€ ì—”ì§„ ìž ê¸ˆ
[[MySQL] ìŠ¤í† ë¦¬ì§€ ì—”ì§„ ìˆ˜ì¤€ì˜ ë½ì˜ ì¢…ë¥˜(ë ˆì½”ë“œ ë½, ê°­ ë½, ë„¥ìŠ¤íŠ¸ í‚¤ ë½, ìžë™ ì¦ê°€ ë½) - MangKyu's Diary (tistory.com)](https://mangkyu.tistory.com/298)

## InnoDB ìŠ¤í† ë¦¬ì§€ ì—”ì§„ ìž ê¸ˆ
**ìŠ¤í† ë¦¬ì§€ ì—”ì§„ ë‚´ë¶€ì—ì„œ ë ˆì½”ë“œ ê¸°ë°˜ì˜ ìž ê¸ˆ ë°©ì‹**ì„ íƒ‘ìž¬í•˜ê³  ìžˆë‹¤. ì´ ë•ë¶„ì— ë›°ì–´ë‚œ ë™ì‹œì„± ì²˜ë¦¬ë¥¼ ì œê³µí•  ìˆ˜ ìžˆë‹¤.
Â 
InnoDB ìŠ¤í† ë¦¬ì§€ ì—”ì§„ì€ ìž ê¸ˆ ì •ë³´ê°€ ìƒë‹¹ížˆ ìž‘ì€ ê³µê°„ìœ¼ë¡œ ê´€ë¦¬ ë˜ê¸° ë•Œë¬¸ì—Â **ë½ ì—ìŠ¤ì»¬ë ˆì´ì…˜**ì´ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.
![[Pasted image 20230808222241.png]]

â–¶ë½ ì—ìŠ¤ì»¬ë ˆì´ì…˜ì´ëž€?
DBMSì—ì„œ ì‚¬ìš©ë˜ëŠ” ë™ì‹œì„± ì œì–´ ê¸°ë²• ì¤‘ í•˜ë‚˜ë¡œ, ë ˆì½”ë“œ ë˜ëŠ” íŽ˜ì´ì§€(ë°ì´í„° ë‹¨ìœ„)ì— ë°œìƒí•œ ì—¬ëŸ¬ ë ˆë²¨ì˜ ìž ê¸ˆ(lock)ì„ **ë” ìƒìœ„ ë ˆë²¨ì˜ ìž ê¸ˆìœ¼ë¡œ ë³€í™˜í•˜ëŠ” ê³¼ì •**ìž…ë‹ˆë‹¤. ì´ ê¸°ë²•ì˜ ëª©í‘œëŠ” ìž ê¸ˆì˜ ìˆ˜ë¥¼ ì¤„ì´ê³ , ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì„ ì¤„ì—¬ ì„±ëŠ¥ì„ ê°œì„ í•˜ê³ , ê²½ìŸ í™˜ê²½ì—ì„œì˜ ê²½í•© ë¬¸ì œë¥¼ ì™„í™”í•˜ê¸° ìœ„í•¨ìž…ë‹ˆë‹¤.


### Record Locks(ë ˆì½”ë“œ ìž ê¸ˆ) âœ”
íŠ¹ì • í–‰ì— ëŒ€í•œ ìž‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë™ì•ˆ **ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì´ í•´ë‹¹ í–‰ì— ë™ì‹œì— ì•¡ì„¸í•˜ì§€ ëª»í•˜ë„ë¡ ì°¨ë‹¨**í•˜ëŠ” ìž ê¸ˆ ë°©ì‹ìž…ë‹ˆë‹¤.Â InnoDB ëŠ”Â ë ˆì½”ë“œ ìžì²´ë¥¼ ìž ê·¸ëŠ” ê²ƒì´ ì•„ë‹Œ **ì¸ë±ìŠ¤ì˜ ë ˆì½”ë“œë¥¼ ìž ê·¼ë‹¤ëŠ” ê²ƒ** ìž…ë‹ˆë‹¤. í–‰ ê¸°ë°˜ ìž ê¸ˆ(ROW ë ˆë²¨)ì´ë¼ê³ ë„ í•˜ë©°, ë°ì´í„°ë² ì´ìŠ¤ ì„±ëŠ¥ê³¼ ë™ì‹œì„±ì„ ê°œì„ í•˜ëŠ” ë° ë„ì›€ì´ ë©ë‹ˆë‹¤.

ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš°ì— ì‚¬ìš©í•©ë‹ˆë‹¤.
1. **ë°ì´í„° ìˆ˜ì • ìž‘ì—…**
í•œ íŠ¸ëžœìž­ì…˜ì´ ë°ì´í„°ë¥¼ ìˆ˜ì •í•  ë•Œ(ì˜ˆ: UPDATE, DELETE, INSERT), í•´ë‹¹ í–‰ì— ëŒ€í•œ Exclusive Lock(ë…ì  ìž ê¸ˆ)ì´ ê±¸ë¦½ë‹ˆë‹¤. ì´ ìž ê¸ˆì€ í•´ë‹¹ ë°ì´í„°ë¥¼ ë™ì‹œì— ë³€ê²½í•˜ëŠ” ì¶©ëŒì„ ë°©ì§€í•˜ë©°, í•´ë‹¹ í–‰ì— ë‹¤ë¥¸ ìž‘ì—…ì„ ì‹œë„í•˜ëŠ” íŠ¸ëžœìž­ì…˜ì€ ëŒ€ê¸°í•˜ê±°ë‚˜ ë‹¤ë¥¸ ë™ìž‘ì„ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤.

2. **ë°ì´í„° ì½ê¸° ìž‘ì—…**
íŠ¸ëžœìž­ì…˜ ë‚´ì—ì„œ ì¼ê´€ëœ ë°ì´í„°ë¥¼ ì½ê¸° ìœ„í•´ Shared Lock(ê³µìœ  ìž ê¸ˆ)ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. í•´ë‹¹ í–‰ì˜ ë°ì´í„°ê°€ ë³€ê²½ë˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ë©°, ë™ì‹œì— ì—¬ëŸ¬ íŠ¸ëžœìž­ì…˜ì´ ê°™ì€ í–‰ì„ ì½ì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.


### Record Locksì˜ ì¢…ë¥˜ëŠ”? âœ”
#### ê³µìœ  ë½(Shared Lock, S-Lock)
- **ì½ê¸° ìž‘ì—…ì‹œ ì‚¬ìš©**ë˜ë©°, **ì—¬ëŸ¬ íŠ¸ëžœìž­ì…˜ì—ì„œ ë™ì‹œì— ë™ì¼í•œ ë°ì´í„°ë¥¼ ì½ì„ ìˆ˜ ìžˆë„ë¡ í—ˆìš©**í•©ë‹ˆë‹¤.
- í•˜ì§€ë§Œ, ê³µìœ  ë½ì´ **í™œì„±í™”ëœ í–‰ì— ëŒ€í•œ ìˆ˜ì •ì„ ì°¨ë‹¨**í•©ë‹ˆë‹¤. ì¦‰, ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì´ í•´ë‹¹ í–‰ì„ ìˆ˜ì •í•˜ë ¤ê³  í•˜ë©´ ë½ì´ í•´ì œë ë•Œê¹Œì§€ ëŒ€ê¸°í•´ì•¼ í•©ë‹ˆë‹¤.

```sql
START TRANSACTION;
SELECT * FROM table_name WHERE id = 1 FOR SHARE; -- ê³µìœ  ë½ ì„¤ì •
-- ... ì—¬ê¸°ì„œ í•„ìš”í•œ ìž‘ì—…ì„ ìˆ˜í–‰
COMMIT; -- íŠ¸ëžœìž­ì…˜ ì»¤ë°‹ ë° ë½ í•´ì œ
```

#### ë² íƒ€ë½(Exclusive Lock, X-Lock)
- **ì“°ê¸° ìž‘ì—…ì‹œ ì‚¬ìš©**ë˜ë©°, í•œ íŠ¸ëžœìž­ì…˜ì—ì„œ ë°ì´í„°ë¥¼ **ìˆ˜ì •í•˜ëŠ” ë™ì•ˆ ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì´ ë™ì¼í•œ ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ê±°ë‚˜ ë°°íƒ€ì  ë½ì„ ìš”ì²­í•  ìˆ˜ ì—†ê²Œ** í•©ë‹ˆë‹¤.
- ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì´ í•´ë‹¹ í–‰ì— ê³µìœ  ë½ì„ ì„¤ì •í•˜ë ¤ê³  í•œë‹¤ë©´, ë°°íƒ€ì  ë½ì´ í•´ì œë  ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•©ë‹ˆë‹¤.

```sql
START TRANSACTION;
SELECT * FROM table_name WHERE id = 1 FOR UPDATE; -- ë°°íƒ€ì  ë½ ì„¤ì •
-- ... ì—¬ê¸°ì„œ í•„ìš”í•œ ìž‘ì—…ì„ ìˆ˜í–‰
COMMIT; -- íŠ¸ëžœìž­ì…˜ ì»¤ë°‹ ë° ë½ í•´ì œ
```


### Gap Locks(ê°­ ìž ê¸ˆ)
ë ˆì½”ë“œ ì‚¬ì´ì˜ ê°„ê²©ì„ ìž ê·¼ë‹¤ëŠ” ê°œë…ìœ¼ë¡œ, **íŠ¹ì • ì¸ë±ìŠ¤ ê°’ì˜ ë²”ìœ„ì— ëŒ€í•œ ìž ê¸ˆ**ìž…ë‹ˆë‹¤. ê°­ ìž ê¸ˆì€ íŠ¸ëžœìž­ì…˜ ê³¼ì •ì—ì„œ **ì¶”ê°€, ì‚­ì œ ë° ìˆ˜ì • ìž‘ì—…ì˜ ë™ì‹œì„±ê³¼ ì¼ê´€ì„±ì„ ìœ ì§€**í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤.

ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš°ì— ì‚¬ìš©í•©ë‹ˆë‹¤.
1. **ë²”ìœ„ ê²€ìƒ‰ì„ ìˆ˜í–‰í•  ë•Œ**
ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ íŠ¹ì • ë²”ìœ„ì˜ ì¸ë±ìŠ¤ ê°’ì— ëŒ€í•œ ìž‘ì—…ì´ ì´ë£¨ì–´ì§ˆ ë•Œ Gap Locksê°€ ì‚¬ìš©ë©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì • ë‚ ì§œ ë²”ìœ„ì˜ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ê±°ë‚˜ ê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ë²”ìœ„ë¥¼ ì •ë ¬í•  ë•Œ ì‚¬ì´ì˜ ê°­ì„ ìž ê·¸ë ¤ ì›ì¹˜ ì•ŠëŠ” ìƒˆë¡œìš´ ë ˆì½”ë“œ ì¶”ê°€ë¥¼ ì°¨ë‹¨í•©ë‹ˆë‹¤.

2. **Repeatable Read ê²©ë¦¬ ìˆ˜ì¤€ì—ì„œì˜ íŠ¸ëžœìž­ì…˜**
ê²©ë¦¬ ìˆ˜ì¤€ì´ Repeatable Readë¡œ ì„¤ì •ëœ ê²½ìš° íŠ¸ëžœìž­ì…˜ ë‚´ì—ì„œ ë°ì´í„° ì¼ê´€ì„±ì„ ìœ ì§€í•˜ê¸° ìœ„í•´ Gap Locksì´ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ ê²©ë¦¬ ìˆ˜ì¤€ì—ì„œ ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì´ ì¿¼ë¦¬ ë²”ìœ„ì— ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ìž…ë ¥í•˜ê±°ë‚˜ ì‚­ì œí•˜ëŠ” ê²ƒì„ ì°¨ë‹¨í•˜ì—¬ íŒ¬í…€ í˜„ìƒì„ ë°©ì§€í•©ë‹ˆë‹¤.

3. **íŠ¸ëžœìž­ì…˜ ë‚´ì—ì„œ ìˆœì°¨ì ìœ¼ë¡œ ì‚½ìž… ìž‘ì—…ì„ ìˆ˜í–‰í•  ë•Œ**
ìžë™ ì¦ê°€(auto-increment) ê°’ì„ ê°€ì§„ í‚¤ ë˜ëŠ” ìˆœì°¨ì  ì¸ë±ìŠ¤ ê°’ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš°, Gap Locksë¥¼ ì‚¬ìš©í•˜ì—¬ ë™ì‹œì— ì‚½ìž…ë˜ëŠ” ê°’ë“¤ ê°„ì˜ ì¶©ëŒì„ ë°©ì§€í•˜ê³  ìˆœì„œë¥¼ ìœ ì§€í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.

ì˜ˆì‹œ) Gap Locks
`WHERE ... BETWEEN`Â ë˜Â `WHERE ... >=`ì™€ ê°™ì€ ë²”ìœ„ ê¸°ë°˜ì˜ ê²€ìƒ‰ ì¿¼ë¦¬ë¥¼ ì‚¬ìš©í•˜ì—¬ ì¸ì ‘ ê°„ê²©ì„ ìž ê¸‰ë‹ˆë‹¤. 
```sql
SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
START TRANSACTION;

-- Gap Locks ì ìš©í•˜ê¸° ìœ„í•œ ì¿¼ë¦¬
SELECT * FROM employees WHERE salary >= 3000 AND salary <= 6000;

COMMIT;
```


### Next-Key Locks(ë‹¤ìŒ í‚¤ ìž ê¸ˆ) âœ”
Next-Key LocksëŠ” ë‘ ê°€ì§€ ì¢…ë¥˜ì˜ ìž ê¸ˆì„ ê²°í•©í•œ ê²ƒìœ¼ë¡œ, **ë ˆì½”ë“œ ìž ê¸ˆ(Record Lock)ê³¼ ê°­ ìž ê¸ˆ(Gap Lock)ì„ ëª¨ë‘ ì‚¬ìš©**í•©ë‹ˆë‹¤. ì´ ë°©ì‹ì€ **ë ˆì½”ë“œì— ëŒ€í•œ ë³€ê²½ ìž‘ì—…ì„ ë™ê¸°í™”í•˜ë©´ì„œ í•´ë‹¹ ë²”ìœ„ì— ëŒ€í•œ ë™ì‹œ ì‚½ìž…ì´ë‚˜ ë³€ê²½ ìž‘ì—…ì„ ì°¨ë‹¨í•˜ì—¬ í¬ê´„ì ì¸ ë™ì‹œì„± ì œì–´ë¥¼ ì œê³µ**í•©ë‹ˆë‹¤.
ë„¥ìŠ¤íŠ¸í‚¤ì™€ ê°­ë½ìœ¼ë¡œ ì¸í•´ ë°ë“œë½ì´ë‚˜ ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì„ ê¸°ë‹¤ë¦¬ê²Œ ë§Œë“œëŠ” ì¼ì„ ìžì£¼ ë°œìƒí•´ ì£¼ì˜ í•„ìš”í•¨.

ë‹¤ìŒê³¼ ê°™ì€ ê²½ìš°ì— ì‚¬ìš©í•©ë‹ˆë‹¤.
1. **ë²”ìœ„ ì¡°íšŒ**
ë²”ìœ„ ê²€ìƒ‰ì´ í•„ìš”í•œ ì¿¼ë¦¬ì—ì„œëŠ” Next-Key Locksê°€ ì‚¬ìš©ë©ë‹ˆë‹¤. ë²”ìœ„ ê²€ìƒ‰ì„ ì‚¬ìš©í•˜ë©´ ì§€ì •ëœ ê¸°ì¤€ì— ë”°ë¼ ì—¬ëŸ¬ ë ˆì½”ë“œë¥¼ í•œ ë²ˆì— ê²€ìƒ‰í•©ë‹ˆë‹¤. ì´ ê²½ìš°, ê° ë ˆì½”ë“œì— ëŒ€í•œ ë§žì¶¤í˜• ìž ê¸ˆê³¼ ì¸ì ‘í•œ ê°„ê²©(JPAì˜ ê°­ ìž ê¸ˆê³¼ ìœ ì‚¬)ì— ëŒ€í•œ ìž ê¸ˆì„ ì œê³µí•˜ì—¬ ë™ì‹œì„± ì œì–´ë¥¼ êµ¬í˜„í•©ë‹ˆë‹¤.

2. **íŠ¸ëžœìž­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ ë†’ì€ ê²½ìš°**
Next-Key Locksì€ íŠ¸ëžœìž­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ì´ `REPEATABLE READ` ë˜ëŠ” `SERIALIZABLE`ì¸ ê²½ìš° ì£¼ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. ì´ëŸ¬í•œ ê²©ë¦¬ ìˆ˜ì¤€ì—ì„œëŠ” íŒ¬í…€ í˜„ìƒì„ ë°©ì§€í•˜ê³  ë™ì‹œì„± ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ ë ˆì½”ë“œ ìž ê¸ˆ ë° ê°­ ìž ê¸ˆì„ ì‚¬ìš©í•©ë‹ˆë‹¤. ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì—ì„œ ë™ì‹œì— ì¸ê·¼ ë ˆì½”ë“œì— ì•¡ì„¸ìŠ¤í•˜ê±°ë‚˜ ë³€ê²½ì„ ì‹œë„í•˜ë ¤ëŠ” ê²½ìš°ì—ë„ Next-Key Locksê°€ ì ìš©ë©ë‹ˆë‹¤.

3. **í–‰ ìˆœì„œë¥¼ ìœ ì§€í•´ì•¼ í•˜ëŠ” ê²½ìš°**
íŠ¸ëžœìž­ì…˜ì—ì„œ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” ë™ì•ˆ í–‰ ìˆœì„œë¥¼ ì¤‘ìš”í•œ ê²ƒìœ¼ë¡œ ê°„ì£¼í•˜ê³  ìœ ì§€í•´ì•¼ í•˜ëŠ” ìƒí™©ì—ì„œë„ Next-Key Locksë¥¼ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, íŠ¹ì • ID ê°’ì— ëŒ€í•œ ì •ë ¬ ìˆœì„œë¥¼ ìœ ì§€í•˜ê±°ë‚˜ ë²”ìœ„ ê²€ìƒ‰ì„ ì‹¤í–‰í•˜ì—¬ ì‚½ìž…ëœ ìƒˆ ë ˆì½”ë“œì˜ ìˆœì„œë¥¼ ì§€ì¼œì•¼ í•˜ëŠ” ê²½ìš°ì— ì‚¬ìš©ë©ë‹ˆë‹¤.

ì˜ˆì‹œ)
Next-Key Locks: í•„ìš”í•œ ê²½ìš°Â `WHERE ... FOR UPDATE`Â ë˜ëŠ”Â `WHERE ... FOR SHARE`Â ì ˆì„ ì¶”ê°€í•˜ì—¬ ë²”ìœ„ ê¸°ë°˜ì˜ ê²€ìƒ‰ ì¿¼ë¦¬ì™€ ë ˆì½”ë“œ ë½ì„ ë™ì‹œì— ì‚¬ìš©í•©ë‹ˆë‹¤.
```sql
SET TRANSACTION ISOLATION LEVEL REPEATABLE READ;
START TRANSACTION;

-- Next-Key Locksë¥¼ ì ìš©í•˜ê¸° ìœ„í•œ ì¿¼ë¦¬
SELECT * FROM employees WHERE salary >= 3000 AND salary <= 6000 FOR UPDATE;

COMMIT;
```


### Auto-Increment Locks(ìžë™ ì¦ê°€ ìž ê¸ˆ) âœ”
**ìžë™ ì¦ê°€ ì»¬ëŸ¼ì˜ ê°’ì„ ë¶€ì—¬í•˜ëŠ” ë™ì•ˆ í•´ë‹¹ í…Œì´ë¸”ì— ì ìš©ë˜ëŠ” ìž ê¸ˆ**ìž…ë‹ˆë‹¤. ì—¬ëŸ¬ íŠ¸ëžœìž­ì…˜ì´ ê°™ì€ ì‹œì ì— ìƒˆë¡œìš´ ë ˆì½”ë“œë¥¼ ì‚½ìž…í•˜ë”ë¼ë„ ê³ ìœ  ID ê°’ì´ ìœ ì§€ë˜ë„ë¡ ë„ì™€ì¤ë‹ˆë‹¤. **ìžë™ìœ¼ë¡œ ì²˜ë¦¬**ë˜ê¸° ë•Œë¬¸ì— ì‚¬ìš©ìžê°€ ì½”ë“œì—ì„œ ëª…ì‹œì ìœ¼ë¡œ í˜¸ì¶œí•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤.

ì˜ˆì‹œ)
```sql
CREATE TABLE employees (
    id INT AUTO_INCREMENT PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    salary REAL
);
```

ìƒˆë¡œìš´ ì§ì› ë ˆì½”ë“œë¥¼ ì¶”ê°€í•˜ëŠ” INSERT ë¬¸
```sql
INSERT INTO employees (first_name, last_name, salary) VALUES ('John', 'Doe', 5000);
```
ì´ ì˜ˆì œì—ì„œ `id` ì—´ì€ `AUTO_INCREMENT` ì†ì„±ì´ ì§€ì •ë˜ì–´ ìžˆìœ¼ë¯€ë¡œ, ìƒˆ ë ˆì½”ë“œê°€ ì¶”ê°€ë  ë•Œë§ˆë‹¤ ê³ ìœ í•œ ê°’ì„ ìžë™ìœ¼ë¡œ í• ë‹¹í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ í•˜ë©´ ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ë“¤ì´ ë™ì‹œì— ì‹¤í–‰ë˜ì–´ë„ ë ˆì½”ë“œì— ì¤‘ë³µë˜ì§€ ì•Šì€ ê³ ìœ í•œ ê°’ì´ í• ë‹¹ë©ë‹ˆë‹¤.


## ì¸ë±ìŠ¤ì™€ ìž ê¸ˆ âœ”
InnoDBì˜ ìž ê¸ˆì€ ë ˆì½”ë“œë¥¼ ìž ê·¸ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ **ì¸ë±ìŠ¤ë¥¼ ìž ê·¸ëŠ” ë°©ì‹**ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤. ì¦‰, **ë³€ê²½í•´ì•¼ í•  ë ˆì½”ë“œë¥¼ ì°¾ê¸° ìœ„í•´ ê²€ìƒ‰í•œ ì¸ë±ìŠ¤ì˜ ë ˆì½”ë“œë¥¼ ëª¨ë‘ ìž ê°€ì•¼ í•œë‹¤.** 

ì˜ˆì‹œ) ìž…ì‚¬ ì¼ìžë¥¼ ì˜¤ëŠ˜ë¡œ ë³€ê²½í•˜ëŠ” ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•´ë³´ë©´?
``` sql
-- ix_firstnameë¡œ first_name ì¹¼ëŸ¼ì˜ ì¸ë±ìŠ¤ ì¤€ë¹„ë˜ì–´ ìžˆìŒ.

SELECT COUNT(*) FROM employees WHERE first_name='Georgi'; 
-- Georgiì¸ ì‚¬ì›ì€ ì „ì²´ 253ëª…

SELECT COUNT(*) FROM employees WHERE first_name='Georgi' AND last_name='Klassen';
-- first_nameì´ Georgiì´ê³  last_nameì´ Klassenì¸ ì‚¬ì›ì€ 1ëª…
```

``` sql
UPDATE employees SET hire_date=NOW()
        WHERE first_name='Georgi' AND last_name='klassen';
```

â–¶ UPDATE ì¿¼ë¦¬ê°€ ì‹¤í–‰ë˜ë©´ 1ê±´ì˜ ë ˆì½”ë“œê°€ ìˆ˜ì •ë  ê²ƒì´ë‹¤. í•˜ì§€ë§Œ ì´ **1ê±´ì˜ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ì„œ ëª‡ ê°œì˜ ë ˆì½”ë“œì— ìž ê¸ˆì´ ê±¸ë¦´ê¹Œ?**
[(27) [10ë¶„ í…Œì½”í†¡] ðŸ”« ìš°ê¸°ì˜ MySQL á„‹á…¡á„á…µá„á…¦á†¨á„Žá…¥ - YouTube](https://www.youtube.com/watch?v=vQFGBZemJLQ?t=495)

![[Pasted image 20230811150716.png]]
UPDATE ì¿¼ë¦¬ì˜ ì¡°ê±´ì—ì„œ ì¸ë±ìŠ¤ë¥¼ ì´ìš©í•  ìˆ˜ ìžˆëŠ” ì¡°ê±´ì€Â `first_name='Georgi'`Â ì´ë©°, **last_name ì»¬ëŸ¼ì´ ì¸ë±ìŠ¤ì— ì—†ê¸° ë•Œë¬¸ì—Â `first_name='Georgi'`Â ì¸ ë ˆì½”ë“œ 253ê±´ì— ëª¨ë‘ ìž ê¸ˆì´ ê±¸ë¦°ë‹¤.**
UPDATE ì¿¼ë¦¬ë¥¼ ìœ„í•´ ì ì ˆížˆ ì¸ë±ìŠ¤ê°€ ì¤€ë¹„ë¼ ìžˆì§€ ì•Šë‹¤ë©´ ê° í´ë¼ì´ì–¸íŠ¸ ê°„ì˜ ë™ì‹œì„±ì´ ìƒë‹¹ížˆ ë–¨ì–´ì§€ë¯€ë¡œ í•œ ì„¸ì…˜ì—ì„œ UPDATE ìž‘ì—…ì„ í•˜ëŠ” ì¤‘ì— ë‹¤ë¥¸ ì„¸ì…˜ì€ ê·¸ í…Œì´ë¸”ì„ ì—…ë°ì´íŠ¸í•˜ì§€ ëª»í•˜ê³  ê¸°ë‹¤ë ¤ì•¼ í•˜ëŠ” ìƒí™©ì´ ë°œìƒí•œë‹¤.


â–¶ë§Œì•½ ì´ í…Œì´ë¸”ì—ì„œ ì¸ë±ìŠ¤ê°€ í•˜ë‚˜ë„ ì—†ë‹¤ë©´ ì–´ë–»ê²Œ ë ê¹Œ?

ì´ëŸ¬í•œ ê²½ìš°ì—ëŠ” í…Œì´ë¸”ì„ í’€ ìŠ¤ìº”í•˜ë©´ì„œ UPDATE ìž‘ì—…ì„ í•˜ëŠ”ë°, ì´ ê³¼ì •ì—ì„œ **í…Œì´ë¸”ì— ìžˆëŠ” 30ì—¬ ë§Œ ê±´ì˜ ëª¨ë“  ë ˆì½”ë“œë¥¼ ìž ê·¸ê²Œ ëœë‹¤**. ì´ê²ƒì´ MySQLì˜ InnoDBì—ì„œ ì¸ë±ìŠ¤ ì„¤ê³„ê°€ ì¤‘ìš”í•œ ì´ìœ  ì¤‘ í•˜ë‚˜ì´ë‹¤.


## ë ˆì½”ë“œ ìˆ˜ì¤€ì˜ ìž ê¸ˆ í™•ì¸ ë° í•´ì œ
ë ˆì½”ë“œ ìˆ˜ì¤€ì˜ ìž ê¸ˆì€ í…Œì´ë¸”ì˜ ë ˆì½”ë“œ ê°ê°ì— ìž ê¸ˆì´ ê±¸ë¦¬ë¯€ë¡œ ê·¸ ë ˆì½”ë“œê°€ ìžì£¼ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤ë©´ ì˜¤ëžœ ì‹œê°„ ë™ì•ˆ ìž ê²¨ì§„ ìƒíƒœë¡œ ë‚¨ì•„ ìžˆì–´ë„ ìž˜ ë°œê²¬ë˜ì§€ ì•ŠëŠ”ë‹¤. 

MySQL 5.1ë¶€í„°ëŠ” ë ˆì½”ë“œ ìž ê¸ˆê³¼ ìž ê¸ˆ ëŒ€ê¸°ì— ëŒ€í•œ ì¡°íšŒê°€ ê°€ëŠ¥í•˜ë¯€ë¡œ ì¿¼ë¦¬ í•˜ë‚˜ë§Œ ì‹¤í–‰í•´ ë³´ë©´ í™•ì¸ ê°€ëŠ¥í•˜ë‹¤.


# MySQLì˜ ê²©ë¦¬ ìˆ˜ì¤€
[[MySQL] íŠ¸ëžœìž­ì…˜ì˜ ê²©ë¦¬ ìˆ˜ì¤€(Isolation Level)ì— ëŒ€í•´ ì‰½ê³  ì™„ë²½í•˜ê²Œ ì´í•´í•˜ê¸° - MangKyu's Diary (tistory.com)](https://mangkyu.tistory.com/299)
[(27) [10ë¶„ í…Œì½”í†¡] ë¡œê±´ì˜ Transaction - YouTube](https://www.youtube.com/watch?v=taUeIi6a6hk)

## íŠ¸ëžœìž­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ì´ëž€?
ë™ì‹œì— ì—¬ëŸ¬ íŠ¸ëžœìž­ì…˜ì´ ì²˜ë¦¬ë  ë•Œ, **íŠ¹ì • íŠ¸ëžœìž­ì…˜ì´ ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì—ì„œ ë³€ê²½í•˜ê±°ë‚˜ ì¡°íšŒí•˜ëŠ” ë°ì´í„°ë¥¼ ë³¼ ìˆ˜ ìžˆë„ë¡ í—ˆìš©í• ì§€ ë§ì§€ë¥¼ ê²°ì •**í•˜ëŠ” ê²ƒì´ë‹¤.
![[Pasted image 20230811161544.png]]


## READ UNCOMMITTED
ê° íŠ¸ëžœìž­ì…˜ì˜ ë³€ê²½ ë‚´ìš©ì´ COMMITì´ë‚˜ ROLLBACK ì—¬ë¶€ì™€ ìƒê´€ ì—†ì´ ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì—ì„œ ë³´ì—¬ì§€ê²Œ ëœë‹¤. ë”í‹° ë¦¬ë“œ(Dirty Read) ë°œìƒí•˜ëŠ” ë¬¸ì œì ì´ ìƒê¸´ë‹¤.

ê·¸ëž˜ì„œ íŠ¸ëžœìž­ì…˜ì˜ ê²©ë¦¬ ìˆ˜ì¤€ìœ¼ë¡œ ì¸ì •í•˜ì§€ ì•Šì„ ì •ë„ë¡œ ë°ì´í„°ì˜ ì •í•©ì„±ì— ì•…ì˜í–¥ì„ ë¼ì¹˜ë¯€ë¡œ í•´ë‹¹ ê²©ë¦¬ ìˆ˜ì¤€ì€ í”¼í•  ê²ƒì„ ê¶Œìž¥í•œë‹¤.


### ë”í‹° ë¦¬ë“œëž€?
ë”í‹° ë¦¬ë“œëž€ **ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì—ì„œ ì²˜ë¦¬í•œ ìž‘ì—…ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìŒì—ë„ ë¶ˆêµ¬í•˜ê³  ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì—ì„œ ë³¼ ìˆ˜ ìžˆê²Œ ë˜ëŠ” í˜„ìƒ**ì„ ë§í•œë‹¤.

ì˜ˆì‹œ) ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì—ì„œ ì‚¬ìš©ìž Bê°€ ì‹¤í–‰í•˜ëŠ” SELECT ì¿¼ë¦¬ì˜ ê²°ê³¼ì— ì‚¬ìš©ìž Aì˜ INSERT ì¿¼ë¦¬ê°€ COMMITë˜ê¸° ì „ì— ì–´ë–¤ ì˜í–¥ì„ ë¯¸ì¹˜ëŠ”ì§€ ë³´ì—¬ì£¼ëŠ” ì˜ˆì‹œì´ë‹¤.
![[Pasted image 20230811154451.png]]
ë¬¸ì œì ì€ ë§Œì•½ ì‚¬ìš©ìž Aê°€ ìž‘ì—… ë„ì¤‘ ë¬¸ì œê°€ ë°œìƒí•˜ì—¬ ì‚½ìž…í•œ ë‚´ìš©ì„ **ë¡¤ë°±í•´ë„ ì‚¬ìš©ìž BëŠ” JuBalì´ ì •ìƒì ì¸ ì‚¬ì›ì´ë¼ íŒë‹¨í•˜ê³  ê³„ì†í•´ì„œ ì²˜ë¦¬**í•˜ê²Œ ëœë‹¤.


## READ COMMITTED
ì˜¤ë¼í´ì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©ë˜ê³  ìžˆìœ¼ë©°, ì˜¨ë¼ì¸ ì„œë¹„ìŠ¤ì—ì„œ ê°€ìž¥ ë§Žì´ ì„ íƒë˜ëŠ” ê²©ë¦¬ ìˆ˜ì¤€ì´ë‹¤. ì–´ë–¤ íŠ¸ëžœìž­ì…˜ì—ì„œ ë°ì´í„°ë¥¼ ë³€ê²½í•˜ë”ë¼ë„ **ì»¤ë°‹ì´ ì™„ë£Œëœ ë°ì´í„°ë§Œ ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì—ì„œ ì¡°íšŒí•  ìˆ˜** ìžˆê¸° ë•Œë¬¸ì´ë‹¤.

**ê·¸ëŸ¬ë‚˜ READ COMMITTED ê²©ë¦¬ ìˆ˜ì¤€ì—ì„œëŠ” NON_REPEATABLE READë¼ëŠ” ë¶€ì •í•© ë¬¸ì œê°€ ì¡´ìž¬í•œë‹¤.**


### ë”í‹° ë¦¬ë“œ(Dirty Read)í•´ê²°
![[Pasted image 20230811154852.png]]
ì‚¬ìš©ìž AëŠ”Â Â `first_name`Â ì„ JuBalì—ì„œ Totoë¡œ ìˆ˜ì •í•˜ì˜€ëŠ”ë°,Â **ì´ë•Œ ìƒˆë¡œìš´ ê°’ì¸ TotoëŠ”Â `employees`Â í…Œì´ë¸”ì— ì¦‰ì‹œ ê¸°ë¡ë˜ê³  ì´ì „ ê°’ì¸ JuBalì€Â `Undo`Â ì˜ì—­ìœ¼ë¡œ ë°±ì—…ì´ ëœë‹¤.**

ì‚¬ìš©ìž Aê°€ ì´ëŸ¬í•œ ë³€ê²½ ë‚´ì—­ì„ ì»¤ë°‹í•˜ê¸° ì „ì— ì‚¬ìš©ìž Bê°€ ì¡°íšŒí•˜ë©´ ê²°ê³¼ ê°’ì€ Totoê°€ ì•„ë‹Œ, ì´ì „ ê°’ì¸ JuBalì´ ì¡°íšŒëœë‹¤.Â ì—¬ê¸°ì„œ ì‚¬ìš©ìž Bì˜ SELECT ì¿¼ë¦¬ ê²°ê³¼ëŠ”Â `employees`Â í…Œì´ë¸”ì´ ì•„ë‹ŒÂ **`Undo`Â ì˜ì—­ì˜ ë°±ì—…ëœ ë ˆì½”ë“œì—ì„œ ê°€ì ¸ì˜¨ ê²°ê³¼ì´ë‹¤.**


### NON-REPEATABLE READ ë°œìƒ
NON-REPEATABLE READëž€, **í•˜ë‚˜ì˜ íŠ¸ëžœìž­ì…˜ ë‚´ì—ì„œ ë™ì¼í•œ SELECT ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í–ˆì„ ë•Œ í•­ìƒ ê°™ì€ ê²°ê³¼ë¥¼ ë³´ìž¥**í•´ì•¼ í•œë‹¤ëŠ” REPEATABLE READ ì •í•©ì„±ì— ì–´ê¸‹ë‚˜ëŠ” ê²ƒì„ ë§í•œë‹¤.

ì˜ˆì‹œ)
![[Pasted image 20230811155053.png]]
Totoë¡œ ìˆ˜ì •í•˜ê³  ì»¤ë°‹í•œ ì „í›„ ì‚¬ìš©ìž Bê°€ ë˜‘ê°™ì€ SELECT ì¿¼ë¦¬ë¡œ ì¡°íšŒí•˜ë©´ ìˆ˜ì • ì „ì—ëŠ” ê²°ê³¼ê°’ì´ ì—†ë‹¤ê°€, ìˆ˜ì • í›„ì—ëŠ” 1ê±´ì˜ ê²°ê³¼ê°€ ì¡°íšŒëœë‹¤. ì´ëŠ” ì‚¬ìš©ìž Bê°€ í•˜ë‚˜ì˜ íŠ¸ëžœìž­ì…˜ ë‚´ì—ì„œÂ **ë™ì¼í•œ SELECT ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í–ˆì„ ë•Œ í•­ìƒ ê°™ì€ ê²°ê³¼ë¥¼ ë³´ìž¥í•´ì•¼ í•œë‹¤ëŠ” REPEATABLE READ ì •í•©ì„±ì— ì–´ê¸‹ë‚˜ê²Œ ëœë‹¤.**

ì›¹ í”„ë¡œê·¸ëž¨ì—ì„œëŠ” í¬ê²Œ ë¬¸ì œê°€ ë˜ì§€ ì•Šì§€ë§Œ, í•˜ë‚˜ì˜ íŠ¸ëžœìž­ì…˜ì—ì„œ ë™ì¼í•œ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ ë²ˆ ì½ê³  ë³€ê²½í•˜ëŠ” ìž‘ì—…ì´ ê¸ˆì „ì ì¸ ì²˜ë¦¬ì™€ ì—°ê²°ë˜ë©´ ë¬¸ì œê°€ ë  ìˆ˜ ìžˆë‹¤.


## REPEATABLE READ
MySQLì˜ InnoDB ìŠ¤í† ë¦¬ì§€ ì—”ì§„ì—ì„œ **ê¸°ë³¸ì ìœ¼ë¡œ ì‚¬ìš©ë˜ëŠ” ê²©ë¦¬ ìˆ˜ì¤€**ì´ë‹¤. ì´ ê²©ë¦¬ ìˆ˜ì¤€ì—ì„œëŠ” READ COMMITTED ê²©ë¦¬ ìˆ˜ì¤€ì—ì„œ ë°œìƒí•˜ëŠ” NON-REPEATABLE READ ë¶€ì •í•©ì´ ë°œìƒí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.
Â 
PHANTOM READ ë¶€ì •í•©ì´ ë°œìƒí•˜ì§€ë§Œ, InnoDB ìŠ¤í† ë¦¬ì§€ ì—”ì§„ì„ ì‚¬ìš©í•  ê²½ìš° PHANTOM READ ë¶€ì •í•©ì´ ë°œìƒìŠµë‹ˆë‹¤.


### NON-REPEATABLE READ í•´ê²°
ì–¸ë‘(Undo) ì˜ì—­ì— **ë°±ì—…ëœ ì´ì „ ë°ì´í„°ë¥¼ í†µí•´ íŠ¸ëžœìž­ì…˜ ë‚´ì—ì„œëŠ” ë™ì¼í•œ ê²°ê³¼ë¥¼ ë³´ì—¬ ì£¼ë„ë¡ ë³´ìž¥**í•˜ì—¬ NON-REPEATABLE READ ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤. 

ì‚¬ì‹¤ READ COMMITTED ê²©ë¦¬ ìˆ˜ì¤€ ë˜í•œ ì–¸ë‘ ì˜ì—­ì— ë°±ì—…ëœ ì´ì „ ë°ì´í„°ë¥¼ ë³´ì—¬ ì£¼ì§€ë§Œ, ë‘ ê²©ë¦¬ ìˆ˜ì¤€ì—ëŠ” ì–¸ë‘ ì˜ì—­ì„ í™œìš©í•˜ëŠ” ë°©ì‹ì´ ë‹¤ë¥´ë‹¤. `REPEATABLE READ` ê²©ë¦¬ ìˆ˜ì¤€ì€ â€˜**ì–¸ë‘ ì˜ì—­ì— ë°±ì—…ëœ ë ˆì½”ë“œì˜ ì—¬ëŸ¬ ë²„ì „ ê°€ìš´ë° ëª‡ ë²ˆì§¸ ë²„ì „ì„ ë³´ì—¬ ì£¼ëƒ**â€™ì— ì°¨ì´ê°€ ìžˆì–´ NON-REPEATABLE READ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìžˆë‹¤.

ì˜ˆì‹œ)
![[Pasted image 20230811161105.png]]
REPEATABLE READ ê²©ë¦¬ ìˆ˜ì¤€ì—ì„œëŠ” ì‹¤í–‰ ì¤‘ì¸ íŠ¸ëžœìž­ì…˜(10ë²ˆ)ë³´ë‹¤ ìž‘ì€ íŠ¸ëžœìž­ì…˜ì—ì„œ ë³€ê²½í•œ ë°ì´í„°ë§Œ ë³´ê²Œ í•˜ì—¬ NON-REPEATABLE READ ë¬¸ì œë¥¼ í•´ê²°í•œë‹¤. ê·¸ëž˜ì„œ ì‚¬ìš©ìž Aì˜ 12ë²ˆ íŠ¸ëžœìž­ì…˜ì—ì„œ ë³€ê²½í•œ ë°ì´í„°ëŠ” ì—´ëžŒí•  ìˆ˜ ì—†ë‹¤.


### PHANTOM READ ë°œìƒ
`SELECT ... FOR UPDATE`Â ì¿¼ë¦¬ì™€ ê°™ì€ **ì“°ê¸° ìž ê¸ˆì„ ê±°ëŠ” ê²½ìš° ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì—ì„œ ìˆ˜í–‰í•œ ë³€ê²½ ìž‘ì—…ì— ì˜í•´ ë ˆì½”ë“œê°€ ë³´ì˜€ë‹¤ê°€ ì•ˆ ë³´ì˜€ë‹¤ê°€ í•˜ëŠ” í˜„ìƒ**ì„ ë§í•œë‹¤.
Â 
![[Pasted image 20230811165112.png]]


### InnoDB ìŠ¤í† ë¦¬ì§€ ì—”ì§„ì—ì„œ PHANTOM READ í•´ê²°í•˜ëŠ” ë°©ë²•ì€?
1. **MVCC ì‚¬ìš©**
InnoDBëŠ” MVCCë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¸ëžœìž­ì…˜ì´ ë™ì‹œì— ë°ì´í„°ì— ì ‘ê·¼í•  ìˆ˜ ìžˆë„ë¡ í•©ë‹ˆë‹¤. MVCCëŠ” ê° íŠ¸ëžœìž­ì…˜ì— ëŒ€í•´ **ë°ì´í„°ì˜ ì—¬ëŸ¬ ë²„ì „ì„ ìœ ì§€í•˜ê³  ê´€ë¦¬**í•˜ë©°, ì´ë¥¼ í†µí•´ ê°™ì€ ë°ì´í„°ë¥¼ ë™ì‹œì— ì½ëŠ” íŠ¸ëžœìž­ì…˜ë“¤ì´ ì„œë¡œ ì˜í–¥ì„ ë¯¸ì¹˜ì§€ ì•Šê²Œ ë©ë‹ˆë‹¤. ì´ ê¸°ë²• ë•ë¶„ì— íŠ¸ëžœìž­ì…˜ ê°„ ë™ì‹œì„±ì´ ê°œì„ ë˜ê³ , íŒ¬í…€ íŒë… í˜„ìƒì´ ëŒ€ë¶€ë¶„ ì°¨ë‹¨ë©ë‹ˆë‹¤.

2. **Next-Key Locking**
InnoDBì˜ ê¸°ë³¸ ê²©ë¦¬ ìˆ˜ì¤€ì¸ REPEATABLE READì—ì„œ ì´ ê¸°ë²•ì´ ì ìš©ë©ë‹ˆë‹¤. Next-Key Lockingì€ **ë ˆì½”ë“œ ë ˆë²¨ì˜ ë½ì„ ì‚¬ìš©í•˜ë©´ì„œë„ ë ˆì½”ë“œ ê°„ì˜ ê°„ê²©ì—ë„ ë½ì„ ê±¸ì–´ ìƒˆë¡œìš´ ë ˆì½”ë“œì˜ ì‚½ìž…ì´ë‚˜ ì‚­ì œë¥¼ ì œí•œ**í•©ë‹ˆë‹¤. ì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨ íŒ¬í…€ íŒë… í˜„ìƒì„ ë°©ì§€í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.


## SERIALIZABLE
ê°€ìž¥ ë‹¨ìˆœí•œ ê²©ë¦¬ ìˆ˜ì¤€ì´ë©´ì„œ ë™ì‹œì— ê°€ìž¥ ì—„ê²©í•œ ê²©ë¦¬ ìˆ˜ì¤€ì´ë‹¤. ê·¸ë§Œí¼ ë™ì‹œ ì²˜ë¦¬ ì„±ëŠ¥ë„ ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ ê²©ë¦¬ ìˆ˜ì¤€ë³´ë‹¤ ë–¨ì–´ì§„ë‹¤.
**í•œ íŠ¸ëžœìž­ì…˜ì—ì„œ ì½ê³  ì“°ëŠ” ë ˆì½”ë“œë¥¼ ë‹¤ë¥¸ íŠ¸ëžœìž­ì…˜ì—ì„œëŠ” ì ˆëŒ€ ì ‘ê·¼í•  ìˆ˜ ì—†ëŠ” ê²ƒ**ì´ë‹¤. ë”°ë¼ì„œ SERIALIZABLE ê²©ë¦¬ ìˆ˜ì¤€ì—ì„œëŠ” ëª¨ë“  ë¶€ì •í•© ë¬¸ì œê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤. ê·¸ëŸ¬ë‚˜ ë™ì‹œ ì²˜ë¦¬ê°€ ê±°ì˜ ë¶ˆê°€ëŠ¥í•˜ë¯€ë¡œ **ì‚¬ìš©ì„ ê¶Œìž¥í•˜ì§€ ì•ŠëŠ”ë‹¤.**