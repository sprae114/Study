ë§í¬ : [[ìë°” orm í‘œì¤€ JPA í”„ë¡œê·¸ë˜ë°.pdf]]
í•´ì‹œíƒœí¬ : #ë‹¤ì–‘í•œì—°ê´€ê´€ê³„

----

## ë‹¤ëŒ€ì¼ [N:1]
#### ğŸ“Œ ë‹¨ë°©í–¥
- ê·¸ë¦¼
![[Pasted image 20230117133403.png]]

- í´ë˜ìŠ¤ êµ¬ì„±
```java
@Entity
public class Member {

	@Id @GeneratedValue
	@Column (name = "MEMBER_ID")
	private Long id;
	
	private String username;
	
	@ManyToOne
	@JoinColumn (name = "TEAM_ID")
	private Team team;

	//Getter, Setter ...
	...
}


@Entity
public class Team {
	@Id @GeneratedValue
	@Column (name = "TEAM_ID")
	private Long id;
	
	private String name;
	
	//Getter, Setter ...
	...
}
```


#### ğŸ“Œ ì–‘ë°©í–¥
- ê·¸ë¦¼
![[Pasted image 20230117133413.png]]

- í´ë˜ìŠ¤ êµ¬ì„±
```java
@Entity
public class Member {

	@Id @GeneratedValue
	@Column (name = "MEMBER_ID")
	private Long id;
	
	private String username;
	
	@ManyToOne
	@JoinColumn (name = "TEAM_ID")
	private Team team;

	public void setTeam (Team team) {
		this.team = team;
		
		// ë¬´í•œë£¨í”„ì— ë¹ ì§€ì§€ ì•Šë„ë¡ ì²´í¬
		if(!team.getMembers().contains(this)) {
			team.getMembers().add(this);
		}
	}
}


@Entity
public class Team {
	@Id @GeneratedValue
	@Column (name = "TEAM_ID")
	private Long id;
	
	private String name;

	@OneToMany(mappedBy = "team")
	private List<Member> members = new ArrayList<>();

	public void setMember (Member member) {
		this.members.add(member);
		
		// ë¬´í•œë£¨í”„ì— ë¹ ì§€ì§€ ì•Šë„ë¡ ì²´í¬
		if(member.getTeam() != this){
			member.setTeam(this);
		}
	}
	...
}
```
=> `@OneToMany(mappedBy)`ë¥¼ ì´ìš©í•´ì„œ ì—°ê´€ê´€ê³„ì˜ ì£¼ì¸ì´ Memberì„ì„ ì•Œë ¤ì¤Œ.
=> ì–‘ìª½ìœ¼ë¡œ ì„œë¡œì°¸ì¡°í•˜ë„ë¡ set ì¬ì •ì˜
=> ë§´ë²„ëŠ” í•˜ë‚˜ì˜ íŒ€ë§Œ ì†í•˜ë„ë¡, ê°ê°ì˜ ë§´ë²„ê°€ íŒ€ì´ ë¹ ì§€ì§€ ì•Šê²Œ ì„¤ì •í•˜ì—¬ ë¬´í•œë£¨í”„ì— ì•ˆë¹ ì§€ê²Œí•¨.

## ì¼ëŒ€ë‹¤ [1:N]
#### ğŸ“Œ ë‹¨ë°©í–¥
=> ê¶Œì¥í•˜ì§€ ì•ŠëŠ” ë°©ì‹, ì‹¤ë¬´ì—ì„œë„ ê±°ì˜ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤. ë‹¤ëŒ€ì¼ë¡œ ë°”ê¿”ì„œ ì‚¬ìš©í•˜ì
![[Pasted image 20230117135110.png]]

![[Pasted image 20230117135259.png]]
=> ì—°ê´€ê´€ê³„ ê´€ë¦¬ë¥¼ ìœ„í•´ 2ê°œì˜ insertì¿¼ë¦¬ê°€ ë‚˜ê°„ í›„, ì¶”ê°€ë¡œ UPDATE SQL ì‹¤í–‰í•˜ëŠ” ëª¨ìŠµ

- ê¶Œì¥í•˜ì§€ ì•ŠëŠ” ì´ìœ ëŠ”?
1)Â **@JoinColumn**ì„ ê¼­ ì‚¬ìš©í•´ì•¼ í•œë‹¤. ë§Œì•½ ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ ì¤‘ê°„ì—Â ì¡°ì¸ í…Œì´ë¸”ì´ ë”°ë¡œ ìƒì„±ë˜ì–´ ë²„ë¦°ë‹¤.
2) DB Tableì—ì„œëŠ” í•­ìƒ Nìª½ì— FKê°€ ìˆê¸°ë•Œë¬¸ì— íŒ¨ëŸ¬ë‹¤ì„ì— ì¶©ëŒì´ ìˆë‹¤.Â **Entityê°€ ê´€ë¦¬í•˜ëŠ” FKê°€ ë‹¤ë¥¸ í…Œì´ë¸”ì— ìˆê²Œëœë‹¤**.
3) ì‹¤ë¬´ í˜„ì¥ì—ì„œëŠ” í…Œì´ë¸”ì´ 1, 2ê°œê°€ ì•„ë‹Œ ìˆ˜ì‹­ê°€ì§€ê°€ ê³µì¡´í•˜ë¯€ë¡œ ê´€ë¦¬ê°€ ì–´ë ¤ì›Œ ì§„ë‹¤.

#### ğŸ“Œ ì–‘ë°©í–¥
=> ë‹¤ëŒ€ì¼ë¡œ ë°”ê¿”ì„œ ì‚¬ìš©í•˜ì.

## ì¼ëŒ€ì¼ [1:1]

=> ì£¼ í…Œì´ë¸”ì´ë‚˜ ëŒ€ìƒ í…Œì´ë¸” ì¤‘ì— ì™¸ë˜ í‚¤ ì„ íƒ ê°€ëŠ¥í•¨.
=> ì™¸ë˜í‚¤ ë°ì´í„°ë² ì´ìŠ¤ì— unique ì œì•½ ì¡°ê±´ ì¶”ê°€

#### ğŸ“Œ ë‹¨í–¥ë±¡ : ì£¼í…Œì´ë¸”ì— ì™¸ë˜í‚¤
![[Pasted image 20230117141308.png]]
=> ì£¼ í…Œì´ë¸”ë§Œ í™•ì¸í•´ë„ ëŒ€ìƒí…Œì´ë¸”ê³¼ ì—°ê´€ê´€ê³„ê°€ ìˆëŠ”ì§€ ì•Œ ìˆ˜ ìˆìŒ.

- í´ë˜ìŠ¤ êµ¬ì„±
```java
@Entity
public class Member {
	@Id @GeneratedValue
	@Column (name = "MEMBER_ID")
	private Long id;
	
	private String username;
	
	@OneToOne
	@JoinColumn (name = "LOCKER_ID")
	private Locker locker;
	

}


@Entity
public class Locker {
	@Id @GeneratedValue
	@Column (name = "LOCKER_ID")
	private Long id;
	
	private String name;
}
```

#### ğŸ“Œ ë‹¨í–¥ë±¡ : ëŒ€ìƒí…Œì´ë¸”ì— ì™¸ë˜í‚¤
![[Pasted image 20230117141449.png]]
=> JPAì—ì„œëŠ” ì§€ì›í•˜ì§€ ì•ŠìŒ.

#### ğŸ“Œ ì–‘ë°©í–¥ : ì£¼í…Œì´ë¸”ì— ì™¸ë˜í‚¤
![[Pasted image 20230117141245.png]]

- í´ë˜ìŠ¤ êµ¬ì„±
```java
@Entity
public class Member {
	@Id @GeneratedValue
	@Column (name = "MEMBER_ID")
	private Long id;
	
	private String username;
	
	@OneToOne
	@JoinColumn (name = "LOCKER_ID")
	private Locker locker;
	

}


@Entity
public class Locker {
	@Id @GeneratedValue
	@Column (name = "LOCKER_ID")
	private Long id;
	
	private String name;
	
	@OneToOne(mappedBy = "locker")
	private Member member;
	...
}
```


#### ğŸ“Œ ì–‘í–¥ë±¡ : ëŒ€ìƒí…Œì´ë¸”ì— ì™¸ë˜í‚¤
- ê·¸ë¦¼
![[Pasted image 20230117145526.png]]

- í´ë˜ìŠ¤ êµ¬ì„±
```java
@Entity
public class Member {
	@Id @GeneratedValue
	@Column (name = "MEMBER_ID")
	private Long id;
	
	private String username;
	
	@OneToOne(mappedBy = "member")
	private Locker locker;
	

}


@Entity
public class Locker {
	@Id @GeneratedValue
	@Column (name = "LOCKER_ID")
	private Long id;
	
	private String name;

	@OneToOne
	@JoinColumn(name = "MEMBER_ID")
	private Member member;
	...
}
```


## ë‹¤ëŒ€ë‹¤ [N:M]
=> ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì •ê·œí™”ëœ í…Œì´ë¸” 2ê°œë¡œ ë‹¤ëŒ€ë‹¤ ê´€ê³„ë¥¼ í‘œí˜„í•  ìˆ˜ê°€ ì—†ë‹¤. ë”°ë¼ì„œ ì—°ê²° í…Œì´ë¸”ì„ ì¶”ê°€í•´ì„œ ì¼ëŒ€ë‹¤, ë‹¤ëŒ€ì¼ ê´€ê³„ë¡œ í’€ì–´ë‚´ì•¼ í•œë‹¤.

- ê·¸ë¦¼
![[Pasted image 20230117150825.png]]

