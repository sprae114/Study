#DBëª…ë ¹ì–´ , #mongoì¿¼ë¦¬  

[[MONGO] ğŸ“š ëª½ê³ ë””ë¹„ CRUD ì¿¼ë¦¬ ë¬¸ë²• ëª…ë ¹ì–´ ğŸ’¯ ì •ë¦¬](https://inpa.tistory.com/entry/MONGO-%F0%9F%93%9A-%EB%AA%BD%EA%B3%A0%EB%94%94%EB%B9%84-%EC%BF%BC%EB%A6%AC-%EC%A0%95%EB%A6%AC)
[[MongoDB] ê°•ì¢Œ 2í¸: Database/Collection/Document ìƒì„±Â·ì œê±° | VELOPERT.LOG](https://velopert.com/457)
[[MONGO] ğŸ“š ëª½ê³ ë””ë¹„ ì¸ë±ìŠ¤(Index) ì •ë¦¬](https://inpa.tistory.com/entry/MONGO-%F0%9F%93%9A-Index-%EC%A0%95%EB%A6%AC#%ED%85%8D%EC%8A%A4%ED%8A%B8_%EC%9D%B8%EB%8D%B1%EC%8A%A4)

---
## êµ¬ì¡°
![[Pasted image 20250116140801.png]]

![[Pasted image 20250116141002.png]]

- ë°ì´í„°ë² ì´ìŠ¤: ê´€ë ¨ëœ ì»¬ë ‰ì…˜ì˜ ì§‘í•©. ì—¬ëŸ¬ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŒ.
- ì»¬ë ‰ì…˜: ê´€ë ¨ëœ ë¬¸ì„œì˜ ì§‘í•©. ê´€ê³„í˜• ë°ì´í„°ë² ì´ìŠ¤ì˜ í…Œì´ë¸”ê³¼ ìœ ì‚¬.
- ë¬¸ì„œ: MongoDBì˜ ê¸°ë³¸ ë°ì´í„° ë‹¨ìœ„. í‚¤-ê°’ ìŒìœ¼ë¡œ êµ¬ì„±ë˜ë©°, BSON í˜•ì‹ìœ¼ë¡œ ì €ì¥ë¨.


## DB ê´€ë¦¬
### í˜„ì¬ DB í™•ì¸
```javascript
db
```

### ëª©ë¡ ì¡°íšŒ
ì»¬ë ‰ì…˜ì„ ìƒì„±í•˜ê¸° ì „ì—ëŠ” ì¡°íšŒ ì•ˆë¨.
```javascript
show databases
```

### ìƒì„±
```javascript
use <database_name>
// use test
```

### ì‚­ì œ
```javascript
// ì‚­ì œí•  ë°ì´í„°ë² ì´ìŠ¤ ì„ íƒ
use <database_name>;

// ë°ì´í„°ë² ì´ìŠ¤ ì‚­ì œ
db.dropDatabase();
```


## ì»¬ë ‰ì…˜ ê´€ë¦¬
### ëª©ë¡ ì¡°íšŒ
```javascript
show collections
```

### ìƒì„±
```javascript
db.createCollection("<collection_name>")
/// db.createCollection("school")
```

### ì‚­ì œ
```javascript
db.<collection_name>.drop()
/// db.school.drop()
```


## ë¬¸ì„œ(ë°ì´í„°) ì¡°ì‘
- `key` ë¶€ë¶„ì˜ `""` ì™€ ` ` ì°¨ì´ê°€ ì—†ë‹¤.

â–¶ í°ë”°ì˜´í‘œë¥¼ ê¼­ ì¨ì•¼ë˜ëŠ” ê²½ìš°
- ëŒ€ì†Œë¬¸ìê°€ êµ¬ë³„ë˜ëŠ” ê²½ìš°(`UserName`)
- íŠ¹ìˆ˜ ë¬¸ìê°€ í¬í•¨ëœ ê²½ìš°(`user-name`)
- ê³µë°±ì´ í¬í•¨ëœ ê²½ìš°(`first name`)

### ì‚½ì…
```javascript
// ë‹¨ì¼ ë¬¸ì„œ ì‚½ì…
db.<collection_name>.insertOne({ "key": "value" })  

// ë‹¤ìˆ˜ ë¬¸ì„œ ì‚½ì… (ğŸ’¥ë¦¬ìŠ¤íŠ¸í˜•ì‹)
db.<collection_name>.insertMany([{ "key1": "value1" }, { "key2": "value2" }]) 
```

```json
db.myCollection.insertOne({
    name: "í™ê¸¸ë™", // ë¬¸ìì—´
    age: 30, // ìˆ«ì
    address: { // ê°ì²´
        street: "ì„¸ì¢…ë¡œ",
        city: "ì„œìš¸",
        postalCode: "03000"
    },
    hobbies: ["ë…ì„œ", "ì—¬í–‰", "ì˜í™” ê°ìƒ"], // ë¦¬ìŠ¤íŠ¸
    education: [ // ë¦¬ìŠ¤íŠ¸ + ê°ì²´
        {
            degree: "í•™ì‚¬",
            major: "ì»´í“¨í„° ê³µí•™",
            year: 2015
        },
        {
            degree: "ì„ì‚¬",
            major: "ì •ë³´ ë³´ì•ˆ",
            year: 2018
        }
    ],
    createdAt: new Date() // í˜„ì¬ ë‚ ì§œì™€ ì‹œê°„
});


```


### ì¡°íšŒ
```javascript
// ëª¨ë“  ë¬¸ì„œ ì¡°íšŒ
db.<collection_name>.find()  
// db.myCollection.find();

// ì¡°ê±´ì— ë§ëŠ” ë¬¸ì„œ ì¡°íšŒ
db.<collection_name>.find({ "key": "value" })  
```

- `_id`ë¡œ ì¡°íšŒ
```json
db.myCollection.find({ _id : ObjectId("6793899edf5efc3f9c9a212e" )});
// ğŸ’¥ _id : "6793899edf5efc3f9c9a212e" ì•„ë‹˜!!
```

- ë¬¸ìì—´ë¡œ ì¡°íšŒ
```json
db.myCollection.find({ name : "í•œì§€ë¯¼" });
```

- ê°ì²´ë¡œ ì¡°íšŒ
```json
db.myCollection.find({ "address.city": "ì„œìš¸" });
```

- ë¦¬ìŠ¤íŠ¸ë¡œ ì¡°íšŒ
```json
db.myCollection.find({ hobbies: "ì—¬í–‰" });
```

- ê°ì²´+ë¦¬ìŠ¤íŠ¸ë¡œ ì¡°íšŒ
```json
db.myCollection.find({"education.degree" : "í•™ì‚¬"});
```

- 2ê°œì´ìƒì˜ ë³µí•©ìœ¼ë¡œ ì¡°íšŒ
```json
db.myCollection.find({ "address.city": "ì„œìš¸", hobbies: "ë…ì„œ" });
```

### ë¹„êµì—°ì‚°ì ì¡°íšŒ
- **`$eq`**: íŠ¹ì • í•„ë“œì˜ ê°’ì´ ì£¼ì–´ì§„ ê°’ê³¼ ê°™ìŒì„ ê²€ì‚¬í•©ë‹ˆë‹¤.
```json
// age == 25
{ "age": { "$eq": 25 } }
```

- **`$ne`**: íŠ¹ì • í•„ë“œì˜ ê°’ì´ ì£¼ì–´ì§„ ê°’ê³¼ ë‹¤ë¦„ì„ ê²€ì‚¬í•©ë‹ˆë‹¤.
```json
// age != 25
{ "age": { "$ne": 25 } }
```

- **`$gt`**: íŠ¹ì • í•„ë“œì˜ ê°’ì´ ì£¼ì–´ì§„ ê°’ë³´ë‹¤ í¼ì„ ê²€ì‚¬í•©ë‹ˆë‹¤.
```json
// age > 25
{ "age": { "$gt": 25 } }
```

- **`$gte`**: íŠ¹ì • í•„ë“œì˜ ê°’ì´ ì£¼ì–´ì§„ ê°’ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ìŒì„ ê²€ì‚¬í•©ë‹ˆë‹¤.
```json
// age >= 25
{ "age": { "$gte": 25 } }
```

- **`$lt`**: íŠ¹ì • í•„ë“œì˜ ê°’ì´ ì£¼ì–´ì§„ ê°’ë³´ë‹¤ ì‘ìŒì„ ê²€ì‚¬í•©ë‹ˆë‹¤.
```json
// age < 25
{ "age": { "$lt": 25 } }
```

- **`$lte`**: íŠ¹ì • í•„ë“œì˜ ê°’ì´ ì£¼ì–´ì§„ ê°’ë³´ë‹¤ ì‘ê±°ë‚˜ ê°™ìŒì„ ê²€ì‚¬í•©ë‹ˆë‹¤.
```json
// age <= 25
{ "age": { "$lte": 25 } }
```

- **`$in`**: íŠ¹ì • í•„ë“œì˜ ê°’ì´ ì£¼ì–´ì§„ ê°’ ëª©ë¡ ì¤‘ í•˜ë‚˜ì™€ ì¼ì¹˜í•¨ì„ ê²€ì‚¬í•©ë‹ˆë‹¤.
```json
// ageëŠ” 20, 25, ë˜ëŠ” 30 ì¤‘ í•˜ë‚˜
{ "age": { "$in": [20, 25, 30] } }
```

- **`$nin`**: íŠ¹ì • í•„ë“œì˜ ê°’ì´ ì£¼ì–´ì§„ ê°’ ëª©ë¡ ì¤‘ ì•„ë¬´ê²ƒê³¼ë„ ì¼ì¹˜í•˜ì§€ ì•ŠìŒì„ ê²€ì‚¬í•©ë‹ˆë‹¤.
```json
// ageëŠ” 20, 25, 30ì´ ì•„ë‹˜
{ "age": { "$nin": [20, 25, 30] } }
```


### ì—…ë°ì´íŠ¸
```javascript
 // ë‹¨ì¼ ë¬¸ì„œ ì—…ë°ì´íŠ¸
db.<collection_name>.updateOne({ "key": "value" }, { $set: { "key": "new_value" } }) 

// ë‹¤ìˆ˜ ë¬¸ì„œ ì—…ë°ì´íŠ¸
db.<collection_name>.updateMany({ "key": "value" }, { $set: { "key": "new_value" } })  
```

```json
db.myCollection.updateOne( { name : "í•œì§€ë¯¼" } , {$set : {name : "ë§ˆë™ì„"} } );

db.myCollection.updateMany( {"hobbies" : "ì—¬í–‰"},  {$set : {age : 12}}  );
```
ë§Œì•½ì— `updateOne`ì¸ë° ì°¾ì€ í•­ëª©ì´ ì—¬ëŸ¬ê°œë©´ ì²«ë²ˆì§¸ ì°¾ì€ê²ƒë§Œ ë°”ê¿ˆ

### ì‚­ì œ
```javascript
// ë‹¨ì¼ ë¬¸ì„œ ì‚­ì œ
db.<collection_name>.deleteOne({ "key": "value" })

// ë‹¤ìˆ˜ ë¬¸ì„œ ì‚­ì œ
db.<collection_name>.deleteMany({ "key": "value" })  

// ì¡°ê±´ì„ ë¹ˆ ê°ì²´ë¡œ ì„¤ì •í•˜ë©´ ëª¨ë“  ë¬¸ì„œë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.
db.<collection_name>.deleteMany({})
```

```json
db.myCollection.deleteOne({name : "í™ê¸¸ë™"})

```
ë§Œì•½ì— `deleteOne`ì¸ë° ì°¾ì€ í•­ëª©ì´ ì—¬ëŸ¬ê°œë©´ ì²«ë²ˆì§¸ ì°¾ì€ê²ƒë§Œ ë°”ê¿ˆ

## ê¸°íƒ€ ìœ ìš©í•œ ëª…ë ¹ì–´
### ë¬¸ì„œ ê°œìˆ˜ ì¡°íšŒ
```javascript
// ëª¨ë“  ë¬¸ì„œ ê°œìˆ˜
db.<collection_name>.countDocuments()  

// ì¡°ê±´ì— ë§ëŠ” ë¬¸ì„œ ê°œìˆ˜
db.<collection_name>.countDocuments({ "key": "value" })  
```


## ì¸ë±ìŠ¤
[[MONGO] ğŸ“š ëª½ê³ ë””ë¹„ ì¸ë±ìŠ¤(Index) ì •ë¦¬](https://inpa.tistory.com/entry/MONGO-%F0%9F%93%9A-Index-%EC%A0%95%EB%A6%AC#%ED%85%8D%EC%8A%A4%ED%8A%B8_%EC%9D%B8%EB%8D%B1%EC%8A%A4)
### ì¸ë±ìŠ¤ ìƒì„±
```javascript
// ì˜¤ë¦„ì°¨ìˆœ ì¸ë±ìŠ¤ ìƒì„±
db.<collection_name>.createIndex({ "key": 1 })  
```

- ë¬¸ìì—´, ìˆ«ì, ë¦¬ìŠ¤íŠ¸
```json
db.myCollection.createIndex({ name: -1 }); // ë‚´ë¦¼ì°¨ìˆœ

// ë°°ì—´ì˜ ê° ìš”ì†Œë¥¼ ê°œë³„ì ìœ¼ë¡œ ì¸ë±ì‹±
db.myCollection.createIndex({ hobbies: 1 }); // ì˜¤ë¦„ì°¨ìˆœ ì¸ë±ìŠ¤
```

- ê°ì²´
```json
// ê°ì²´ ì „ì²´ì— ëŒ€í•œ ì¸ë±ìŠ¤ë¥¼ ìƒì„± : address í•„ë“œì— í¬í•¨ëœ ëª¨ë“  ì •ë³´ê°€ ì¸ë±ìŠ¤ì— ì €ì¥
db.myCollection.createIndex({ address : 1})

// í•„ë“œì— ëŒ€í•œ ì¸ë±ìŠ¤ë¥¼ ìƒì„± : city ê°’ë§Œ ì¸ë±ìŠ¤ì— ì €ì¥
db.myCollection.createIndex({ "address.city": 1 });
```

- ë³µí•©ì¸ë±ìŠ¤
```json
// ì—¬ëŸ¬ ê°œì˜ í•„ë“œë¥¼ ì¡°í•©í•˜ì—¬ ìƒì„±í•˜ëŠ” ì¸ë±ìŠ¤
db.myCollection.createIndex({ "address.city": 1, "address.postalCode": 1 });
```

### ì¸ë±ìŠ¤ ëª©ë¡ ì¡°íšŒ
```javascript
db.<collection_name>.getIndexes()
```

### ì¸ë±ìŠ¤ ì‚­ì œ
```javascript
db.<collection_name>.dropIndex("<index_name>")
```
