#HTTP웹기본지식

#쿠키

----
[쿠키와 세션 개념 (tistory.com)](https://interconnection.tistory.com/74)
[[10분 테코톡] 파인의 쿠키와 웹 스토리지 - YouTube](https://www.youtube.com/watch?v=c7eLPK9RzEM)
[[10분 테코톡] 🦄 디토의 웹스토리지 & 쿠키 - YouTube](https://www.youtube.com/watch?v=-4ZsGy1LOiE)

#HTTP웹기본지식03

# 쿠키
## 쿠키란? ✔
**브라우저에 저장**되는 key와 value로 이루어진 **작은 크기의 문자열(4KB)** 이다. 쿠키를 사용하지 않으면, HTTP 특성(비연결성, 무상태성)때문에 **방문 여부를 파악**하지 못함.

![[Pasted image 20221229155447.png]]
![[Pasted image 20221229155510.png]]


## 쿠키의 기본 동작 방식은? ✔
![[Pasted image 20221229105444.png]]
1) 클라이언트가 페이지를 **요청**
2) **서버에서 쿠키를 생성**후, **HTTP 헤더**에 쿠키를 포함 시켜 **응답**
3) 같은 요청을 할 경우 **HTTP 헤더에 쿠키**를 함께 보냄 how? 브라우저가 종료되어도 쿠키 만료 기간이 있다면 클라이언트에서 보관하고 있음
4) 서버에서 쿠키를 읽어 이전 상태 정보를 변경 할 필요가 있을 때 쿠키를 업데이트 하여 변경된 쿠키를 HTTP 헤더에 포함시켜 응답


## 쿠키의 정보는 어떤게 있을까?  
- 이름(key) : 각각의 쿠키를 구별하는 데 사용되는 이름
- 값(value) : 쿠키의 이름과 관련된 값
- 유효시간 : 쿠키의 유지시간
- 도메인 : 쿠키를 전송할 도메인
- 경로 : 이 경로를 포함한 하위 경로 페이지만 쿠키 접근


## 쿠키의 종류는?
- 영속 쿠키: 만료 날짜를 입력하면 **해당 날짜까지 유지** 
- 세션 쿠키: 만료 날짜를 생략하면 **브라우저 종료시** 까지만 유지


## 쿠키 사용 예시 ✔
- **세션 관리** : 서버에 저장해야 할 로그인, 장바구니, 게임 스코어 등의 정보 관리
- **개인화** : 사용자 선호, 테마 등의 세팅
- **트래킹** : 사용자 행동을 기록하고 분석하는 용도


## 쿠키의 문제점과 해결방법은? ✔
#### 보안 문제
https://velog.io/@chltjdrhd777/XSS-CSRF
[인증요청1. 세션(Session)을 사용하려면, 웹보안을 알아야 한다. [TIL / node.js] (velog.io)](https://velog.io/@jejualrock/%EC%9D%B8%EC%A6%9D%EC%84%B8%EC%85%98)

▶XSS(Cross-site Scripting) 공격
- 문제점 : 공격자가 **악성 스크립트를 삽입**하여 브라우저에서 실행해 사용자 정보 탈취
![[Pasted image 20231207022425.png]]

- 해결방법
1) Secure 속성은 쿠키가 **HTTPS를 통해서만 전송**
2) HttpOnly 속성은 **JavaScript를 통한 쿠키 접근을 차단**하여 XSS(Cross-Site Scripting) 공격을 방지


▶CSRF(Cross-site request forgery ) 공격
- 문제점 : **사용자인 척 악성 request**를 보내는 공격
![[Pasted image 20231207022457.png]]

- 해결방법 : **SamSite 속성**을 사용해 사이트와 **같은 도메인 요청**에만 쿠키를 전송함.


#### 용량 문제
- 문제점 : 쿠키는 4kB의 작은 용량이지만 **많이 쌓이면 문제**가 됌. 
![[Pasted image 20221229155535.png]]

- 해결방법 : 세션, 로컬 스토리지, IndexedDB 등 **다른 클라이언트 측 저장 방법**을 사용


#### 트래픽 증가
- 문제점 : HTTP 요청시 **모든 쿠키가 자동으로 전달**되므로, **불필요한 트래픽의 양이 증가**함.

- 해결 방법 : 쿠키를 최소한으로 사용하고, **필요한 정보만 쿠키에 저장**하도록 합니다. 또한, 쿠키의 **유효 범위**(Path, Domain)를 가능한 한 제한적으로 설정하여, 쿠키가 전송되는 요청의 범위를 줄일 수 있습니다.


# 웹스토리지
## 웹스토리지란? ✔
HTML5부터 지원하는 브라우저에서 사용할 수 있는 클라이언트 측 저장 기술로, 쿠키와 비슷한 역할을 하지만, **더 큰 저장 용량**과 **개선된 보안성**을 제공합니다.


## 웹스토리지 특징은?
- **5MB의 저장 용량** : 쿠키의 부족한 저장 용량 문제 해결
- **요청 시 Headers에 전송하지 않음** : 쿠키의 CSRF, 트래픽 문제 해결
- 문자열만 저장 가능 : 직렬화를 통해 객체 저장 가능


## 웹 스토리지 종류는?
#### 로컬 스토리지(Local Storage)
- 사용자의 브라우저에 **데이터를 영구적으로 저장하도록 허용**.
- 도메인 (domain)이 다른 경우에는 로컬 스토리지에 접근할 수 없다. (naver로 google 못함.)
- 테마 설정, 장바구니 정보  등...


#### 세션 스토리지(Session Storage)
- 브라우저를 닫으면 세션 스토리지의 **모든 데이터는 자동으로 삭제**됌. 또한, 각 세션마다 데이터가 **개별적으로 저장**된다.
- 같은 도메인이라도 세션이 다르면 데이터에 접근할 수 없다.
- 임시 입력 데이터, 로그인 세션 관리  등...


## 웹 스토리지의 문제점과 해결방안은?

#### 보안 문제
문제점 : XSS 공격을 통해 공격자가 웹 스토리지의 데이터를 탈취하는 것도 가능합니다.

해결방안: 중요한 정보는 웹 스토리지에 저장하지 않고 **서버 측에서 관리**해야 합니다. 또한, 웹사이트는 가능한 한 XSS 공격을 방지하는 **보안 조치**를 적용해야 합니다.


#### 용량 제한
문제점: 일반적으로 한 웹사이트당 5MB~10MB로 제한됩니다.

해결방안: 필요한 데이터만 웹 스토리지에 저장하고, 나머지는 서버에 저장하거나 다른 저장 방식을 사용해야 합니다.