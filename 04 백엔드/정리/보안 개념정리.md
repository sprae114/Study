
참고자료
1) [[10분 테코톡] 🎡토니의 인증과 인가 - YouTube](https://www.youtube.com/watch?v=y0xMXlOAfss&t=481s)
2) [[10분 테코톡] 🤠루피의 인증과 인가 - YouTube](https://www.youtube.com/watch?v=JZgD8aPkHSc)

----

#### 📌인증(authentication) VS 인가(authorization)란?
▶인증
- (식별 가능한 정보로) 서비스에 등록된 유절의 신원을 입증하는 과정을 뜻한다.
- 사용자가 주장하는 사람인지 여부를 결정합니다. 즉, 증명해야됌
- ex) 회사에 출근했을 때, (닉네임과 사워증 같은 정보로) 회사 소속으로 확인하는 과정을 인증이라 함.

▶인가
- 인증된 사용자에 대한 자원 접근 권한을 확인하는 것을 말함.
- ex) 나는 4F 개발팀에 있는 소속이다. 하지만 다른 층에는 권한이 없게 때문에 맘대로 들어갈 수가 없음.


#### 📌웹에서 보는 인증과 인가는?
웹에 있는 게시판을 쓴다고 생각해보자.
- 웹 게시판을 들어가기 위해 로그인하는 행위 -> 인증
- 웹 게시판에서 글을 쓰는 행위 -> 인가 O
- 웹 게시판에서 다른 사람의 글을 수정할 수 없는 행위 -> 인가 X

#### 📌Request Header를 활용 로그인 처리 변천사
▶웹사이트에 **로그인 요청**하기
![[Cap 2023-02-04 16-06-38-163.jpg]]
- 브라우저가 url을 인코딩을 한후 API를 요청해야함.
![[Cap 2023-02-04 15-54-23-450.jpg]]
- **브라우저가 인코딩 처리하는 방식** 간단하게 나타낸것


▶로그인 처리가 된 상황
![[Cap 2023-02-04 16-08-01-641.jpg]]
- HTTP를 전송함. 그러면 서버가 DB체킹을 하고 실제 DB값이 있으므로 로그인 처리함.
- 하지만 HTTP는 **무상태 프로토콜**임으로, 매번 로그인해야되는 문제점 발생

▶**쿠키**를 이용해서 로그인 상태 유지
![[Cap 2023-02-04 16-12-50-247.jpg]]
- 브라우저의 스토리지(ex. 쿠키, 세션스토리지)를 이용함. 즉 **브라우저에 저장**되어 사용함
- 로그인 상황이 필요할 때, 사용자의 아이디와 비밀번호를 같이 요청에 넣어서 보내줌.
- 그러나, 스토리지에 **사용자가 정보가 raw하게 저장**되어 있어, 보안에 취약함.

▶**세션**을 이용해서 보안 개선
![[Cap 2023-02-04 16-15-52-985.jpg]]
- 사용자의 정보를 raw하게 보내주는 것이 아니라 세션을 도입해서, 인증된 사용자의 식별자와 랜덤한 문자열로 **세션 ID를 만들어서 이를 응답에 넘겨 클라이언트가 저장**할 수 있게함.
- 정보를 탈취해도 의미있는 정보가 있지 않아서 **안전**하고, **만료기간을 설정**할 수 있어 보안을 개선함.
- 하지만, 서버가 한대가 아니라 여러대가 된다면 **세션 동기화문제**가 생김.

▶서버가 여러 대인 경우 세션처리
![[Cap 2023-02-04 16-20-38-192.jpg]]
- **서버가 여러 대**인 경우, 첫번째 요청은 서버3에 세션 ID를 저장했지만, 두번째 요청은 로드밸런싱에 의해 서버2에 갔다고 생각해보자. 이러면 서버2에는 다시 로그인 처리해야되는 문제점이 있음.
![[Cap 2023-02-04 16-31-30-273.jpg]]
- 이러한 문제점을 해결하기 위해, 세션스토리지를 써서 **세션을 한곳에서 관리**해서 해결함.
![[Cap 2023-02-04 16-33-14-864.jpg]]
- 하지만 클라이언트가 많아져 **요청이 많아지게 되면**, 세션스토리지 서버가 터지는 문제점이 있음,

▶Token
![[Cap 2023-02-04 16-35-45-629.jpg]]
- 클라이언트, 서버, 세션 스토리지에 사용자의 정보를 관리하게 했더니 문제가 생김. 그래서 무상태에서 비롯된 문제니깐 정보의 요청 즉, **HTTP에서 해결**해보자고 생각함.
![[Cap 2023-02-04 16-39-37-871.jpg]]
- 그중에 대표적인게 JWT인데, **JWT**는 **시크릿 키**를 사용해서 만들어내고, 시크릿 키를 사용해서 JWT의 인증 과정을 거침. 해독하기 쉽기 때문에 민감한 정보는 담지 않음.
- 이 시크릿키는 서버의 내부에서 안전하게 관리하고 있음.
![[Cap 2023-02-04 16-38-59-687.jpg]]
- JWT는 클라이언트와 서버 간의 상태 **비저장 인증**을 가능하게 하여 API 인증 및 권한 부여에 유용함.


## OAuth
ㅁㅁ OAuth란?
=> 다른 웹사이트 상의 자신들의 정보에 대해 접근 권한을 부여할 수 있는 공통적인 개방형 표준 수단이다. 카카오톡, 네이버를 이용한 로그인을 하는 경우를 말함.
![[Pasted image 20230204173254.png]]
- mine(만든 서비스)는 원래 ID/Password를 통해서 인증해야했음. 하지만 그 역할은 Thier(구글, 네이버..)에 넘김. 하지만 Thier은 ID/Password와 같은 민감한 정보를 잘 모르는 사이트(mine)에게 줄 수 없음. 그래서 Thier은 로그인 처리가 되면 접글 할 수 있는 accessToken을 발행함. 그러면 mine은 accessToken로 인가로 사용할 수 있음.

ㅁㅁ 인증 절차는?
![[Pasted image 20230204172718.png]]

![[Pasted image 20230204172920.png]]