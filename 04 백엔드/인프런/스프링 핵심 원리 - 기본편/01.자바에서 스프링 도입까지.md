ë§í¬ : [[ìŠ¤í”„ë§ í•µì‹¬ ì›ë¦¬  ê¸°ë³¸í¸.pdf]] (page. 2, 21)
í•´ì‹œíƒœí¬ : #DIP, #OCP, #IOC, #ìŠ¤í”„ë§ì»¨í…Œì´ë„ˆ
ë§ˆì§€ë§‰ ë³µìŠµ : #23/01/31
í•´ë‹¹ í”„ë¡œì íŠ¸ : mvc1/corespring

----
## (ì½”ë“œ) MemberServiceì½”ë“œ ê³ ì¹˜ê¸°
#### ğŸ“Œê¸°ì¡´ ì½”ë“œì˜ ë¬¸ì œì ì€?
```java
public class MemberServiceImpl implements MemberService {   
    private final MemberRepository memberRepository = new MemoryMemberRepository();  
  
    @Override  
    public void join(Member member) {  
  
    }  
  
    @Override  
    public Member findMember(Long memberId) {  
        return memberRepository.findById(memberId);  
    }  
}
```

=> ì˜ì¡´ ê´€ê³„ê°€ ì¸í„°í˜ì´ìŠ¤ ë¿ë§Œ ì•„ë‹ˆë¼ **êµ¬í˜„ê¹Œì§€ ëª¨ë‘ ì˜ì¡´í•˜ëŠ” ë¬¸ì œ**ê°€ ìˆë‹¤. ê·¸ë ‡ê²Œ ë˜ë©´ ì½”ë“œë¥¼ Repositoryë¥¼ ë°”ê¾¸ê¸° ìœ„í•´ `MemberService`ê¹Œì§€ ë“¤ì–´ê°€ì„œ í™•ì¸í•˜ê³  ë°”ê¿”ì•¼í•¨. (DIP ìœ„ë°°)
```java
 private final MemberRepository memberRepository = new MemoryMemberRepository();  
```


#### ğŸ“Œí•´ê²°ì±…
```java
private final MemberRepository memberRepository;  
  
public Test(MemberRepository memberRepository) {  
    this.memberRepository = memberRepository;  
}
```
=>ì¸í„°í˜ì´ìŠ¤ íƒ€ì… ì„ ì–¸í•œ í›„, **ìƒì„±ìë¥¼ í†µí•´ì„œ ì°¸ì¡°**ë¥¼ ì£¼ì…í•˜ì!!


## (ì½”ë“œ) OrderServiceì½”ë“œ ê³ ì¹˜ê¸°
#### âœ”ê¸°ì¡´ ì½”ë“œì˜ ë¬¸ì œì ì€?
![[Pasted image 20221214182557.png]]
```java
public class OrderServiceImpl implements OrderService{  
  
    private final MemberRepository memberRepository = new MemoryMemberRepository();  
    // private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();  
  
    @Override  
    public Order createOrder(Long memberId, String itemName, int itemPrice) {  
        Member member = memberRepository.findById(memberId);  
        int discountPrice = discountPolicy.discount(member, itemPrice);  
  
        return new Order(memberId, itemName, itemPrice, discountPrice);  
    }  
}
```
=> 1) í• ì¸ ì •ì±…ì„ **ë³€ê²½í•˜ë ¤ë©´** í´ë¼ì´ì–¸íŠ¸ì¸ `OrderServiceImpl` ì½”ë“œë¥¼ `FixDiscountPolicy`ì—ì„œ `RateDiscountPolicy`ë¡œ ê³ ì³ì•¼ í•œë‹¤. (DIPìœ„ë°°)
=> 2) ì§€ê¸ˆ êµ¬í˜„ì²´ì˜ ì—­í• ì€ ìƒì„±ê³¼ ì§€ì • + **í–‰ë™ ë‘ê°œ**ë¡œ ë˜ì–´ìˆë‹¤ (SRP ìœ„ë°°)


#### ğŸ“ŒDIP í•´ê²°ì±…
```java
public class OrderServiceImpl implements OrderService {

  private final MemberRepository memberRepository;
  private final DiscountPolicy discountPolicy;

  public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy discountPolicy) {
    this.memberRepository = memberRepository;
    this.discountPolicy = discountPolicy;
  }
}
```
=> **ìƒì„±ì ì£¼ì…**ì„ í†µí•´ì„œ ì˜ì¡´ì„± í•´ê²°í–ˆìŒ. ê·¸ëŸ¬ë‚˜ ëˆ„êµ°ê°€ê°€ í´ë¼ì´ì–¸íŠ¸ì¸ `OrderServiceImpl`ì— `DiscountPolicy`ì˜ êµ¬í˜„ ê°ì²´ë¥¼ ëŒ€ì‹  ìƒì„±í•˜ê³  ì£¼ì…í•´ì¤˜ì•¼ í•œë‹¤. 


#### ğŸ“ŒSRP í•´ê²°ì±…
```java
public class AppConfig {

  public MemberService memberService() {
    return new MemberServiceImpl(new MemoryMemberRepository());
  }

  public OrderService orderService() {
    return new OrderServiceImpl(new MemoryMemberRepository(), new FixDiscountPolicy());
  }

}
```
=> ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì „ì²´ ë™ì‘ ë°©ì‹ì„ êµ¬ì„±í•˜ê¸° ìœ„í•´, êµ¬í˜„ ê°ì²´ë¥¼ ìƒì„±í•˜ê³  ì—°ê²°í•˜ëŠ” ì±…ì„ì„ ê°€ì§„ **ë³„ë„ì˜ ì„¤ì • í´ë˜ìŠ¤**ë¥¼ ë§Œë“ ë‹¤.

- ê·¸ë¦¼ìœ¼ë¡œ í™•ì¸í•˜ê¸°
![[Pasted image 20221214184213.png]]
![[Pasted image 20221214184223.png]]


## (ì½”ë“œ) APPêµ¬ì„±ì˜ ë¬¸ì œì  
#### ğŸ“Œê¸°ì¡´ ë¬¸ì œì 
```java
public class AppConfig {

  public MemberService memberService() {
    return new MemberServiceImpl(new MemoryMemberRepository());
  }

  public OrderService orderService() {
    return new OrderServiceImpl(new MemoryMemberRepository(), new FixDiscountPolicy());
  }

}
```
=> ì—­í• ì´ ì–´ë–¤ ê²Œ ìˆê³  ê·¸ **ì—­í• ì´ ì–´ë–¤ ê±¸ êµ¬í˜„**í•˜ëŠ”ì§€ í•œ ëˆˆì— ë³´ì´ëŠ” ê²Œ ì¤‘ìš”í•œë° í˜„ì¬ì˜ `AppConfig`ë¡œëŠ” ê·¸ê²Œ ë³´ì´ì§ˆ ì•ŠëŠ”ë‹¤.
=>ì˜ˆë¥¼ë“¤ì–´, í• ì¸ì •ì±…ì„ ê³ ì • í• ì¸ì •ì±…ë§ê³  ë¹„ìœ¨í• ì¸ì •ì±…ìœ¼ë¡œ ë°”ê¾¸ê³  ì‹¶ë‹¤ê³  ìƒê°í•´ë³´ì. ê·¸ëŸ°ë° í• ì¸ì •ì±… ì—­í• (í•¨ìˆ˜ì˜ ì´ë¦„)ì´ ë³´ì´ì§€ ì•Šê²Œ ë˜ê³ , í•¨ìˆ˜ë¥¼ ì½”ë“œë¥¼ í•˜ë‚˜í•˜ë‚˜ ì°¾ì•„ì„œ í™•ì¸í•´ë³´ê³  ë°”ê¿”ì•¼í•œë‹¤ëŠ” ëœ».


#### ğŸ“Œí•´ê²°ì±…
```java
public class AppConfig {
  // ë©”ì„œë“œ ëª…ì„ ë³´ëŠ” ìˆœê°„ ì—­í• ì´ ë“œëŸ¬ë‚œë‹¤.
  // memberServiceì—ì„œëŠ” memberServiceImplì„ ì“¸ ê²ƒì´ë‹¤.
  public MemberService memberService() {
    return new MemberServiceImpl(memberRepository());
  }

  // memberRepositoryëŠ” memoryë¡œ ì“¸ ê²ƒì´ë‹¤.
  // ê·¸ë˜ì„œ ë‚˜ì¤‘ì— ë‹¤ë¥¸ repositoryë¥¼ ì“°ë ¤ë©´ ì´ ì½”ë“œë§Œ ë°”ê¾¸ë©´ ëœë‹¤.
  private MemberRepository memberRepository() {
    return new MemoryMemberRepository();
  }

  public OrderService orderService() {
    return new OrderServiceImpl(memberRepository(), discountPolicy());
  }

  private DiscountPolicy discountPolicy() {
    return new FixDiscountPolicy();
  }

}
```
=> êµ¬í˜„ì²´ **ìƒì„±ê³¼ ì£¼ì…ì„ ë¶„ë¦¬**í–ˆë‹¤. ì´ì œ `discountPolicy()`ì˜ í•¨ìˆ˜ë¥¼ ë³´ê³  êµ¬í˜„ì²´ `new FixDiscountPolicy()` ë¥¼ ë°”ê¾¸ë©´ ëœë‹¤.


## IoC, DI, ì»¨í…Œì´ë„ˆ
#### âœ”IOC(Inversion of Control)ì´ë€?
ì œì–´ì˜ ì—­ì „ìœ¼ë¡œ, í”„ë¡œê·¸ë¨ ì œì–´ë¥¼ êµ¬í˜„ì²´ê°€ ì§ì ‘ ì œì–´ë¥¼ í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ **Appconfigì— ê´€ë¦¬**í•˜ëŠ” ê²ƒì„ ë„˜ê²¨ì¤€ ê²ƒì²˜ëŸ¼ ì¼ì–´ë‚˜ëŠ” í˜„ìƒ.


#### âœ”í”„ë ˆì„ì›Œí¬ vs ë¼ì´ë¸ŒëŸ¬ë¦¬ ì°¨ì´ëŠ”?
ì¶œì²˜ : [ë¼ì´ë¸ŒëŸ¬ë¦¬? í”„ë ˆì„ì›Œí¬? ì°¨ì´ì  ì•„ì§ë„ ëª¨ë¦„? 5ë¶„ ìˆœì‚­. - YouTube](https://www.youtube.com/watch?v=t9ccIykXTCM)

- ê³µí†µì  : ë‹¤ë¥¸ ëˆ„êµ°ê°€ê°€ ì“´ ì½”ë“œë¥¼ ë‚´ê°€ í•„ìš”í•œ í”„ë¡œì íŠ¸ì— ì“°ëŠ” ê²ƒ
- ì°¨ì´ì  : ëˆ„ê°€ **Controller**í•˜ëƒì— ë‹¤ë¦„
	ë¼ì´ë¸ŒëŸ¬ë¦¬ :
		ë‚´ê°€ í•„ìš”í• ë•Œ ì‚¬ìš©í•˜ëŠ” ë„êµ¬ë“¤ì˜ ì§‘í•©
		ex) **ë‚´ê°€ í•„ìš”í• ë•Œ, ë¡¬ë³µì„ ì†Œí™˜**í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒ
	í”„ë ˆì„ì›Œí¬:
		í”„ë ˆì„ì›Œí¬ê°€ ì •í•œ ê·œì¹™ì„ ë”°ë¼ì•¼í•¨. ì–´ë””ì— í…œí”Œë¦¿ë„£ê³ , ì»¨íŠ¸ë¡¤ë„£ê³ , ... 
		ex)ë‚´ê°€ **ê·œì¹™ì— ë”°ë¼ ì‘ì„±í•œ ì½”ë“œë¥¼ ìŠ¤í”„ë§ í”„ë ˆì„ì›Œí¬ ë™ì‘**ì‹œí‚´


#### âœ”APIë€?
ì¶œì²˜ : [(2) ì½”ë”©ì´ˆë³´ë“¤ì´ í—·ê°ˆë¦¬ëŠ” ìš©ì–´ : APIê°€ ë­ëƒë©´ - YouTube](https://www.youtube.com/watch?v=ckSdPNKM2pY)


#### âœ”ì˜ì¡´ê´€ê³„ ì£¼ì…ì´ë€?
ì¶œì²˜ : [[Spring] ì˜ì¡´ì„± ì£¼ì…(Dependency Injection, DI)ì´ë€? ë° Springì´ ì˜ì¡´ì„± ì£¼ì…ì„ ì§€ì›í•˜ëŠ” ì´ìœ ](https://mangkyu.tistory.com/150)

Â ì™¸ë¶€ì—ì„œ **ë‘ ê°ì²´ ê°„ì˜ ê´€ê³„ë¥¼ ê²°ì •í•´ì£¼ëŠ” ë””ìì¸ íŒ¨í„´**ìœ¼ë¡œ,Â ì¸í„°í˜ì´ìŠ¤ë¥¼ ì‚¬ì´ì— ë‘¬ì„œ í´ë˜ìŠ¤ ë ˆë²¨ì—ì„œëŠ” ì˜ì¡´ê´€ê³„ê°€ ê³ ì •ë˜ì§€ ì•Šë„ë¡ í•˜ê³  ëŸ°íƒ€ì„ ì‹œì— **ê´€ê³„ë¥¼ ë™ì ìœ¼ë¡œ ì£¼ì…í•˜ì—¬ ìœ ì—°ì„±ì„ í™•ë³´**í•˜ê³  ê²°í•©ë„ë¥¼ ë‚®ì¶œ ìˆ˜ ìˆê²Œ í•´ì¤€ë‹¤.

- ì‹¤í–‰ì „ì˜ ë‹¤ì´ì–´ê·¸ë¨
![[Pasted image 20221214195620.png]]
- ì‹¤í–‰í›„ ë‹¤ì´ì–´ ê·¸ë¨
![[Pasted image 20221214195648.png]]
=>ì´ë¡œì¨ ì˜ì¡´ê´€ê³„ ì£¼ì…ì„ ì‚¬ìš©í•˜ë©´ í´ë¼ì´ì–¸íŠ¸ ì½”ë“œë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³ , í´ë¼ì´ì–¸íŠ¸ê°€ í˜¸ì¶œí•˜ëŠ” ëŒ€ìƒì˜ íƒ€ì… ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.

#### ğŸ“ŒBean ì •ë¦¬
ì¶œì²˜ : [[Spring] Bean ì •ë¦¬ ](https://velog.io/@gillog/Spring-Bean-%EC%A0%95%EB%A6%AC)

- ë¹ˆì´ë€?  
	Spring IoC Containerê°€ ê´€ë¦¬í•˜ëŠ” ìë°” ê°ì²´, Spring Bean Containerì— ì¡´ì¬í•˜ëŠ” **ê°ì²´** 

- ë¹ˆì˜ íŠ¹ì§•
	1) Springì—ì„œÂ `Bean`ì€ ë³´í†µÂ **`Singleton`** ìœ¼ë¡œ ì¡´ì¬
	2) `Spring IoC(Inversion of Control)` **`Contatiner`ì— ì˜í•´Â ì¸ìŠ¤í„´ìŠ¤í™”, ê´€ë¦¬, ìƒì„±**ëœë‹¤.
	3) **`@ComponentScan`,Â `@Component`Â Anotationì„ ì‚¬ìš©**í•´ì„œÂ `Bean`ì„ ìë™ ë“±ë¡í•˜ëŠ” ë°©ë²•ì´ ìˆìŒ.


####  ğŸ“ŒControllerì™€ Beanì˜ ì°¨ì´ì ì´ ë­ì§€??  
- Controller: ë“¤ì–´ì˜¤ëŠ” **HTTP ìš”ì²­ì„ ì²˜ë¦¬**í•˜ê³  ì²˜ë¦¬ë¥¼ ìœ„í•œ ì ì ˆí•œ **ë©”ì„œë“œì— ë§¤í•‘í•˜ëŠ” Spring MVCì˜ êµ¬ì„± ìš”ì†Œ**ì…ë‹ˆë‹¤.
- Bean: Springì˜ **IoC ì»¨í…Œì´ë„ˆê°€ ê´€ë¦¬í•˜ëŠ” ê°ì²´**ì´ë‹¤. Beanì€ Spring ì»¨í…Œì´ë„ˆì— ì˜í•´ ìƒì„±, ì—°ê²° ë° ê´€ë¦¬ë©ë‹ˆë‹¤. ì„œë¹„ìŠ¤, ë¦¬í¬ì§€í† ë¦¬ ë˜ëŠ” ë„ë©”ì¸ ê°œì²´ì™€ ê°™ì€ **ëª¨ë“  ìœ í˜•ì˜ ê°œì²´ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë° ì‚¬ìš©**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


## ìë°”ì—ì„œ ìŠ¤í”„ë§ìœ¼ë¡œ ì „í™˜
#### ğŸ“Œ(ì½”ë“œ) ìŠ¤í”„ë§ìœ¼ë¡œ ì „í™˜í•˜ëŠ” ì½”ë“œ
- AppConfigë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆë¡œ ì „í™˜í•˜ê¸°
```java
@Configuration
public class AppConfig {

  @Bean
  public MemberService memberService() {
    return new MemberServiceImpl(memberRepository());
  }

  @Bean
  public MemberRepository memberRepository() {
    return new MemoryMemberRepository();
  }

  @Bean
  public OrderService orderService() {
    return new OrderServiceImpl(memberRepository(), discountPolicy());
  }

  @Bean
  public DiscountPolicy discountPolicy() {
    return new RateDiscountPolicy();
  }
}
```
- `@Configuration`  ì´ ë¶™ì€ **AppConfig ë¥¼ ì„¤ì •(êµ¬ì„±) ì •ë³´**ë¡œ ì‚¬ìš©
- `@Bean` ì´ ë¶™ì€ ë©”ì„œë“œë¥¼ ëª¨ë‘ í˜¸ì¶œí•´ì„œ ë°˜í™˜ëœ **ê°ì²´ë¥¼ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆì— ë“±ë¡**í•¨. ì´ ê°ì²´ë“¤ì„ ìŠ¤í”„ë§ ë¹ˆì´ë¼í•¨(ì´ë¦„ì€ ë©”ì„œë“œëª…)

#### ğŸ“ŒìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ë™ì‘ê³¼ì • ì„¤ëª…
1) ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±
![[Pasted image 20221214202611.png]]
=> **`new AnnotationConfigApplicationContext(AppConfig.class)` ë¡œ ìŠ¤í”„ë§ ì»¨í…Œì´ë„ˆ ìƒì„±**ì‹œ ì„¤ì • í´ë˜ìŠ¤ ì§€ì •í•¨.

2) ìŠ¤í”„ë§ ë¹ˆ ë“±ë¡ (ì‹±ê¸€í†¤ ê°ì²´ë¡œ ë“±ë¡ëŒ) 
=> ë“±ë¡ í›„ì— ì˜ì¡´ê´€ê³„ ì£¼ì…ì´ ìë™ì ìœ¼ë¡œ ì¼ì–´ë‚¨
![[Pasted image 20221214202855.png]]

3) ì˜ì¡´ê´€ê³„ í˜•ì„±
![[Pasted image 20221214202907.png]]

