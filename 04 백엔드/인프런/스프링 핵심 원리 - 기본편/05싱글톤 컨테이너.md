## 웹 애플리케이션에서 싱글톤을 쓰는 이유?  
-   웹 애플리케이션은 여러 고객이 동시에 요청함. 그때마다 객체를 생성하면 메모리낭비된다.
	- ![](https://api.transno.com/v3/document_image/3fc23795-efae-4559-9d7a-f74d813383f9-10826299.jpg)  

##  [기존 싱글톤 패턴의 문제점?](https://www.inflearn.com/questions/72691)  
-   싱글톤 패턴을 **구현 코드** 자체가 많이 들어간다.  
-   의존관계상 클라이언트가 구체 클래스에 의존한다. **DIP, OCP 원칙를 위반**한다.  
-   내부 속성을 변경하거나 초기화 하기 어렵다 결론적으로 **유연성이 떨어진다.**  

## 싱글톤 방식의 주의점은?
- [ ] 무상태로 설계해야 함 why?  
	-   특정 클라이언트에 의존적인 필드가 있으면 안된다.  
	-   특정 클라이언트가 값을 변경할 수 있는 **필드가 있으면 안된다!** 가급적 읽기만 가능해야 한다.  
	-   필드 대신에 자바에서 공유되지 않는, 지역변수, 파라미터, ThreadLocal 등을 사용해야 한다.  
- [ ] 무상태로 설계하지 않으면 어떤 참사가 일어남?
	- ![코드](https://api.transno.com/v3/document_image/dfbaae8e-8912-4ae9-afac-5999f6a62a4b-10826299.jpg)  
- [ ] 그러면 어떻게 바꿔야할까?  
     -  기존에 문제가 됐던 클래스![](https://api.transno.com/v3/document_image/6fe736b1-c382-4e94-b537-51c03436fd87-10826299.jpg)  
     -   바뀐 클래스 => 상태를 유지하는 필드를 없애고, 현재 price를 반환하게 함.![](https://api.transno.com/v3/document_image/6e4f02ca-caa2-4f31-b899-a8ea818a6471-10826299.jpg)  

## 스프링 컨테이너에서 싱글톤이 일어나는 OK, 근데 그게 어떤 것 때문에 나타나는 거지?
-   `@ Configuration`를 통해 싱글톤 등록함  
- [ ]   AppConfig의 자바 코드를 보면 분명히 각각 2번 new MemoryMemberRepository 호출해서 다른 인스턴스가 생성되어야 하는데?
	-  스프링이 CGLIB라는 바이트코드 조작 라이브러리를 사용해서 AppConfig 클래스를 상속받은 임의의 다른 클래스를 만들고, 그 다른 클래스를 스프링 빈으로 등록한 것![](https://api.transno.com/v3/document_image/57187b95-28ba-4303-a289-9b8c3ef1ad50-10826299.jpg)  
-   @ Configuration 을 적용하지 않고, @ Bean 만 적용하면 어떻게 될까?  
     -   싱글톤 보장 X