#HTTP웹기본지식

#세션

----
https://surprisecomputer.tistory.com/36

# 세션
#HTTP웹기본지식04
## 세션이란? ✔
일정 시간 동안 같은 브라우저로부터 들어오는 요청을 하나의 상태로 보고 그 **상태를 유지**하는 기술이다.
세션은 쿠키를 기반하고 있지만, 사용자 정보 파일을 브라우저에 저장하는 쿠키와 달리 세션은 **서버 측에서 관리**
![[Pasted image 20231208161904.png]]


## 세션의 특징은? ✔
- 각 클라이언트에게 **고유 ID**를 부여함.
- 서버에 저장하기 때문에, **보안** 면에서 쿠키보다 우수
- **사용자가 많아질수록 서버 메모리를 많이 차지**하게 됨. 


## 쿠키와 세션의 차이점은?
![[Pasted image 20221229165117.png]]


## 세션 매커니즘 ✔
#### 인증전
![[Pasted image 20231208170024.png]]
1) 사용자가 Post로 로그인 요청함.
2) 서버는 DB를 통해 사용자가 맞으면, 세션정보를 생성 후 Session ID를 발급함.
3) 쿠키를 통해서 Session ID를 전달해줌.


#### 인증후
![[Pasted image 20231208170112.png]]
1) 로그인이 필요한 페이지에 쿠키에 Session 아이디를 넣어서 요청.
2) 세션이 만료되지 않았다면, 세션 ID를 통해 유저 확인하기.
3) 로그인 된 상태의 페이지를 클라이언트에게 보여줌.


## 세션 불일치 문제
[🌐 세션(Session) 불일치 문제 및 해결 방법 (tistory.com)](https://inpa.tistory.com/entry/WEB-%F0%9F%8C%90-%EC%84%B8%EC%85%98Session-%EB%B6%88%EC%9D%BC%EC%B9%98-%EB%AC%B8%EC%A0%9C-%ED%95%B4%EA%B2%B0%EB%B2%95-%E2%B8%A2%EC%84%9C%EB%B2%84-%EB%8B%A4%EC%A4%91%ED%99%94-%ED%99%98%EA%B2%BD-%E2%B8%A5#session_clustering_%EB%B0%A9%EC%8B%9D)

▶ 문제점
**여러 대의 서버**를 이용하는 경우 세션을 동시에 관리해야 하므로, **세션 정보를 저장하고 관리**하는 데 성능 문제가 발생합니다. 

![[Pasted image 20231208173630.png]]
서버 1의 세션이 저장되어 있지만, 로드 밸런싱에 의해 서버 2에 요청을 보냄.


▶ 해결 방안
#### 1) Sticky Session 방식
클라이언트의 요청이 어느 한 서버에 도달해 세션 데이터가 생겼다면, 앞으로 **이 서버는 해당 클라이언트만의 요청/응답만 처리하도록 고정**해주는 방식

![[Pasted image 20231208173819.png]]

하지만, 이 방식은 특정 서버에 **트래픽이 집중**되는 문제와 하나의 **서버의 장애**가 발생하면 인증의 문제가 생겨 선호하지 않음.


#### 2) Session Clustering 방식
세션 정보를 각 서버마다 저장하는게 아닌 **세션 데이터를 복사해 서버들에게 전파**하는 방식.
![[Pasted image 20231208174241.png]]

하지만, 이 방식은 추가적인 네트워트 I/O가 발생하진 않지만, 그만큼 많은 **메모리가 필요**하다는 단점과 세션이 전파되기까지의 **시간차로 인한 세션 불일치** 문제가 있다.


#### 3) Session Storage 방식
별도의 **세션 저장소를 외부에서 생성**하고 각 서버들이 가져와 사용하는 방식이다. Session은 영구적인 저장이 필요하지 않아 Redis와 같은 **In-Memory** 데이터 저장 방식 사용함.
![[Pasted image 20231208174917.png]]

하지만, 이 방식은 추가적으로 in-memory를 사용하기 때문에 **추가 비용**이 들고,  Session storage로부터 세션을 불러와야 하기 때문에 **추가적인 네트워트 I/O가 발생**함.


#### 4) Token 방식
[[06. 토큰]]에서 알아보자.