

## 주요 용어 정리

|항목|의미|
|---|---|
|`http_req_duration`|요청 1건의 전체 응답 시간 (요청~응답 완료까지)|
|`http_req_blocked`|요청 전에 대기한 시간 (DNS 조회, TCP 핸드셰이크, 커넥션 풀 등)|
|`VU` (Virtual Users)|동시에 접속한 가상 사용자 수|
|`Requests per second`|초당 처리된 요청 수|
|`p90`, `p95`|상위 90%, 95% 사용자의 응답 시간 (ex. p90이 1초면, 90%는 1초 이내 응답 받음)|

---

## 2. 분석 포인트

### Virtual Users & Requests per Second
활성 VU 수와 초당 요청 수(RPS)를 보면, 이 수치를 기준으로 “얼마나 동시 접속 처리가 가능한가?” 판단 가능.  ex) 최대 500 VU, RPS 평균 129, 최대 568

###  2-2. 응답 시간 (http_req_duration)
응답이 20~30초면 사용자가 이탈할 확률이 높음. ex) mean (평균): 5.92초 → 전체 평균 응답 시간

###  2-3. http_req_blocked
- 커넥션 풀 부족이나 DNS 지연 가능성 검토. 요청 전 블로킹 시간이 대부분 0이면 좋음. ex) mean 10.71ms → 괜찮은 편, max 86.27ms, p95 58.19ms → 일부에서 살짝 delay 있음

## 3. Grafana 분석
![[Pasted image 20250420173620.png]]
![[Pasted image 20250420174406.png]]
이 Grafana 대시보드는 시스템 성능 메트릭을 모니터링하는 데 사용된 것으로 보입니다. 주요 지표를 분석해 보겠습니다:
1. Virtual Users (VU)
   - 활성 VU는 1.50K로, 테스트 중 최대 1.60K까지 증가했습니다. 시간대 01:20~01:30 사이에 VU가 급격히 증가한 것을 볼 수 있습니다.

1. Requests per Second (RPS)
   - 초당 요청 수는 평균 106~287 사이로 변동하며, 01:10~01:30 사이에 VU 증가와 함께 RPS도 급등했습니다. 최대 300에 가까운 요청이 발생했습니다.

1. Errors Per Second & Checks Per Second
   - 이 두 지표는 "No data"로 표시되어 있어, 해당 기간 동안 오류나 체크가 기록되지 않았거나 데이터가 수집되지 않았음을 의미합니다.

1. HTTP Request Duration
성능 병목 지점: 평균 요청 시간이 13.30초로 길고, 최대 39.90초까지 걸리는 요청이 존재합니다. 이는 시스템이 부하를 감당하지 못하거나 특정 요청이 비정상적으로 느린 가능성을 시사합니다. 특히 P90/P95 값이 높아 상위 10% 요청의 지연이 심각합니다.

   - 평균 (Mean): 13.30초로, 요청 처리 시간이 상당히 긴 편입니다.
   - 최대 (Max): 39.90초로, 일부 요청이 매우 느리게 처리되었습니다.
   - 중앙값 (Median): 10.28초로, 절반 이상의 요청이 이 시간 안에 처리되었습니다.
   - 최소 (Min): 51.41ms로, 가장 빠른 요청은 매우 짧은 시간 안에 완료되었습니다.
   - P90 (90번째 백분위): 33.37초로, 90%의 요청이 이 시간 안에 처리되었습니다.
   - P95 (95번째 백분위): 36.29초로, 상위 5% 요청이 더 긴 지연을 겪었습니다.

1. HTTP Request Duration (Over Time)
   - 왼쪽 그래프: 최대, 최소, P90, P95 값을 시간에 따라 추적합니다. 00:40~00:45 사이에 요청 시간이 급등했다가 감소하며 안정화되었습니다. 01:10 이후 다시 약간 증가하는 추세입니다.
   - 오른쪽 히트맵: 요청 시간이 64ms에서 16.4초 사이에 분포하며, 대부분의 요청이 250ms~4.10초 사이에 집중되어 있습니다. 그러나 일부 요청이 16.4초까지 걸리는 긴 지연이 발생했습니다.


### 주요 지표 분석:

1. HTTP Request Blocked 시간 (요약):
   - 평균 (Mean): 41.14ms로, 요청이 차단된 평균 시간이 비교적 짧습니다.
   - 최대 (Max): 146.55ms로, 일부 요청에서 차단 시간이 길게 나타났습니다.
   - 중앙값 (Median): 50.13ms로, 절반 이상의 요청이 이 시간 안에 차단 해소 후 진행되었습니다.
   - 최소 (Min): 0.00ms로, 일부 요청은 차단 없이 즉시 처리되었습니다.
   - P90 (90번째 백분위): 83.65ms로, 90%의 요청이 이 시간 안에 차단 해소되었습니다.
   - P95 (95번째 백분위): 93.71ms로, 상위 5% 요청에서 더 긴 차단 시간이 발생했습니다.

1. HTTP Request Blocked (Over Time):
   - 왼쪽 그래프: 최대, P90, P95, 최소 값을 시간에 따라 추적합니다.
     - 00:40~00:45 사이에 차단 시간이 급등하여 최대 250ms에 가까운 값을 기록했습니다.
     - 이후 00:45~01:00 사이에 안정화되었으나, 01:10~01:15 사이에 다시 차단 시간이 증가하며 최대 64ms까지 올라갔습니다.
     - 01:15 이후 다시 안정화되어 최소값은 거의 0ms에 가까워졌습니다.
   - 오른쪽 히트맵: 차단 시간 분포를 보여줍니다.
     - 대부분의 요청은 0.0039ms~1ms 사이에 집중되어 있으며, 이는 매우 짧은 차단 시간을 의미합니다.
     - 그러나 일부 요청은 16ms~64ms 사이에 분포하며, 극히 드물게 256ms까지 차단된 요청이 존재합니다.

### 이전 대시보드와의 연관성 분석:
- Virtual Users (VU) 및 Requests per Second (RPS): 이전 대시보드에서 VU와 RPS가 01:20~01:30 사이에 급등했음을 확인했습니다. 하지만 `http_req_blocked`에서는 이 시간대에 큰 차단 시간 증가가 보이지 않습니다. 이는 차단 시간이 요청량 증가와 직접적인 상관관계가 없음을 시사합니다.
- HTTP Request Duration: 이전 대시보드에서 평균 요청 시간이 13.30초로 매우 길었고, 최대 39.90초까지 걸렸습니다. 반면 `http_req_blocked`의 평균은 41.14ms로, 요청 처리 지연의 주요 원인이 차단 시간보다는 서버 처리 속도나 응답 지연일 가능성이 높습니다.
- 패턴 비교: `http_req_blocked`의 최대값(146.55ms)은 00:40~00:45에 발생했는데, 이는 이전 대시보드의 `http_req_duration`이 급등했던 시간대와 일치합니다. 초기 부하 증가로 인해 네트워크 연결 설정에 일시적인 병목이 발생했을 가능성이 있습니다.

### 종합 분석 및 개선 제안:
- 차단 시간의 영향: `http_req_blocked`의 평균값(41.14ms)은 전체 요청 시간(평균 13.30초)에 비해 미미한 수준입니다. 따라서 요청 지연의 주요 원인은 차단 시간이 아니라 서버 처리 지연, 데이터베이스 응답 속도, 또는 애플리케이션 로직일 가능성이 큽니다.
- 문제 원인: 차단 시간이 00:40~00:45 및 01:10~01:15에 급등한 것은 네트워크 초기 연결 지연, DNS 조회 문제, 또는 방화벽 설정과 관련이 있을 수 있습니다.
- 개선 방안:
  1. 네트워크 최적화: DNS 조회 속도를 개선하거나, TCP 연결 설정 시간을 줄이기 위해 네트워크 구성을 점검하세요.
  2. 서버 부하 관리: `http_req_duration`이 길기 때문에 서버 리소스(CPU, 메모리) 사용량을 확인하고, 필요하면 서버를 증설하거나 로드 밸런싱을 도입하세요.
  3. 모니터링 강화: `http_req_blocked`의 최대값(146.55ms)이 발생한 원인을 파악하기 위해 해당 시간대의 네트워크 로그를 분석하는 것이 좋습니다.

추가적인 로그나 메트릭(예: CPU 사용률, 메모리 사용량)이 있다면 더 구체적인 원인을 파악할 수 있을 것 같습니다. 필요하면 더 분석해 드릴게요!